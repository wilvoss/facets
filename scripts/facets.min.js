Vue.config.devtools=!1,Vue.config.debug=!1,Vue.config.silent=!0,Vue.config.ignoredElements=["app"];var app=new Vue({el:"#app",data:{appDataVersion:"2.0.30",appDataActionButtonTexts:{send:"Send",guess:"Guess",check:"Check",copy:"Copy",respond:"Respond",create:"Create",share:"Share"},appDataCards:[],appDataCardsParked:[],appDataLanguages:AllLanguages,appDataConfirmationObject:{message:"Did they have the right answer?",target:"correct"},appDataDraggedCard:new CardObject({}),appDataDraggedCardStartedInParkingLot:!1,appDataEmptyCard:new CardObject({id:"ghost"}),appDataGameCatchphrase:"A Puzzle Game of Words and Wits!",appDataGameName:"Facets",appDataGhostX:0,appDataGhostY:0,appDataParkingScrollLeft:0,appDataGlobalCreatedGames:[],appDataDailyGames:[],appDataUserDailyGamesStarted:[],appDataHints:[],appDataMessage:"",appDataParkingInputValue:"",appDataPlayerCurrent:new PlayerObject({}),appDataPlayerCreator:new PlayerObject({}),appDataPlayerSender:new PlayerObject({}),appDataShareURL:"",appDataTimeoutCardRotation:null,appDataTimeoutTrayRotation:null,appDataTimeoutNotification:null,appDataTransitionLong:0,appDataTransitionShort:0,appDataWordSets:[...WordSets],appCurrentDailyGameKey:-1,appDailyIsFreshToday:!0,appDataNumberOfNewDailies:1,appDataDailyGamesStats:[],appStateForceAutoCheck:!1,appStateIsDragging:!1,appStateIsGettingTinyURL:!1,appStateIsGettingLast10Games:!1,appStateIsGettingDailyGames:!1,appStateIsGuessing:!1,appStateIsModalShowing:!1,appStateIsNewVersionAvailable:!1,appStatePageHasLoaded:!1,appStateShowCatChooser:!1,appStateShowConfirmation:!1,appStateShowGlobalCreated:!1,appStateShowDailyGames:!1,appStateShowInfo:!1,appStateShowIntro:!1,appStateShowOOBE:!1,appStateShowStats:!1,appStateShowSettings:!1,appStateShowTutorial:!1,appStateTrayIsRotating:!1,appStateTrayRotation:0,appStateUsePortraitLayout:!1,appStateShowNotification:!0,appParkingRightButtonDisabled:!1,appStateShowMeta:!1,vsShowDaily:!0,appStateUseFlower:!1,currentGameGuessCount:0,currentGameGuessersName:"",currentGameLanguage:"",currentGameGuessingCardCount:4,currentGameGuessingWordSet:WordSets.find((t=>"100"===t.id)),currentGameReviewIsFinal:!1,currentGameSolutionActual:"",currentGameSolutionGuessing:[],currentGameWordSet:WordSets.find((t=>"100"===t.id)),userSettingsUseExtraCard:!1,userSettingsUsesLightTheme:!1,userSettingsUsesSimplifiedTheme:!1,userSettingsUseMultiColoredGems:!0,userSettingsUseWordSetThemes:!1,userSettingsStreaks:[],userSettingsFocus:!0,userSettingsLanguage:"en-us",userSettingsLegalAccepted:!1,tempName:"",tempID:0,tempShareURLCode:"",tempUseMultiColoredGems:!0,tempUserSettingsUsesLightTheme:!1,tempUserSettingsUsesSimplifiedTheme:!1,tempUseWordSetThemes:!1,tempWordSetName:"",tempUsePortraitLayout:!1,tempUseExtraCard:!1,tempWordSets:[],tempUserSettingsLanguage:"en-us",documentCssRoot:document.querySelector(":root"),cssStyles:window.getComputedStyle(document.querySelector(":root"))},methods:{ToggleShowTutorial(t){note("ToggleShowTutorial() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateShowTutorial=!this.appStateShowTutorial},ToggleUseLightTheme(t){this.userSettingsUsesLightTheme=t,this.userSettingsUsesLightTheme?document.getElementById("themeColor").content="hsl(140, 100%, 92%)":document.getElementById("themeColor").content="hsl(215, 100%, 3%)"},ToggleUseSimplifedTheme(t){this.userSettingsUsesSimplifiedTheme=t,this.userSettingsUsesSimplifiedTheme&&(this.tempUseMultiColoredGems=!0)},ToggleFocus(){window.innerWidth<=660&&(this.userSettingsFocus=!this.userSettingsFocus)},async ToggleShowGlobalCreated(t){note("ToggleShowGlobalCreated() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateShowGlobalCreated=!this.appStateShowGlobalCreated,0===this.appDataGlobalCreatedGames.length&&this.GetLast10GlobalCreatedGames()},async ToggleShowDailyGames(t){note("ToggleShowDailyGames() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateShowDailyGames=!this.appStateShowDailyGames,0===this.appDataDailyGames.length&&this.GetDailyGames()},ToggleShowInfo(t){note("ToggleShowInfo() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateShowInfo=!this.appStateShowInfo},ToggleShowMeta(t){note("ToggleShowMeta() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateShowMeta=!this.appStateShowMeta},SetTempLanguage(t){note("SetTempLanguage() called"),this.tempUserSettingsLanguage=t},ToggleTempUseWordSetThemes(){note("ToggleTempUseWordSetThemes() called"),this.tempUseWordSetThemes=!this.tempUseWordSetThemes},ToggleTempUseLightTheme(){note("ToggleTempUseLightTheme() called"),this.tempUserSettingsUsesLightTheme=!this.tempUserSettingsUsesLightTheme},ToggleTempUseSimplifiedTheme(){note("ToggleTempUseSimplifiedTheme() called"),this.tempUserSettingsUsesSimplifiedTheme=!this.tempUserSettingsUsesSimplifiedTheme},ToggleTempUsePortraitLayout(){note("ToggleTempUsePortraitLayout() called"),this.tempUsePortraitLayout=!this.tempUsePortraitLayout},ToggleTempUseMultiColoredGems(){note("ToggleTempUsePortraitLayout() called"),this.tempUseMultiColoredGems=!this.tempUseMultiColoredGems},ToggleTempUseExtraCard(){note("ToggleTempUseExtraCard() called"),this.tempUseExtraCard=!this.tempUseExtraCard},ShowCategoryPicker(){this.tempWordSetName=this.getCurrentSelectedTempWordSetName},ShowSettings(t){note("ShowSettings() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateIsModalShowing=!0,this.appStateShowSettings=!0,this.GetCategoryNames()},GetCategoryNames(){this.tempWordSets=[],this.tempWordSetName=this.getCurrentSelectedTempWordSetName,this.appDataWordSets.forEach((t=>{this.tempWordSets.push(new WordSetObject(t))})),this.tempName=this.appDataPlayerCurrent.name},SetWordSetTheme(t){if(note("SetWordSetTheme() called"),this.userSettingsUseWordSetThemes)this.documentCssRoot.style.setProperty("--texture2","url("+t.textureImage+")"),this.documentCssRoot.style.setProperty("--textureSize",t.textureSize),this.documentCssRoot.style.setProperty("--textureBlendMode",t.textureBlendMode),this.documentCssRoot.style.setProperty("--textureHue",t.textureHue);else{let t=this.documentCssRoot.style.getPropertyValue("--textureSource");this.documentCssRoot.style.setProperty("--texture2",t),this.documentCssRoot.style.setProperty("--textureSize","cover"),this.documentCssRoot.style.setProperty("--textureBlendMode","normal");let e=this.documentCssRoot.style.getPropertyValue("--textureHueSource");this.documentCssRoot.style.setProperty("--textureHue",e)}this.documentCssRoot.style.setProperty("--wordScale",t.scale)},async LoadTranslatedWords(){let t=await this.GetCurrentGameWordSet(),e={};t.forEach((t=>{e[t.id]=t})),this.appDataCards.forEach((t=>{t.words.forEach((t=>{e[t.id]&&(t.value=e[t.id].value)}))})),this.appDataCardsParked.forEach((t=>{t.words.forEach((t=>{e[t.id]&&(t.value=e[t.id].value)}))}))},async GetCurrentGameWordSet(){note("GetCurrentGameWordSet() called");let t=[],e=""===this.userSettingsLanguage?"":this.userSettingsLanguage+"/";""!==this.currentGameLanguage&&(e=this.currentGameLanguage);let a=this.currentGameWordSet.data.map((async t=>{let a=t.toString().replace("./data/","./data/"+e);this.currentGameWordSet.noLanguage&&(a=t.toString().replace("./data/","./data/common/"));const s=await fetch(a);return await s.json()}));try{let e=await Promise.all(a);t=[].concat(...e)}catch(t){}return t},async GetGuessingGameWordSet(){note("GetGuessingGameWordSet() called");let t=""===this.userSettingsLanguage?"":this.userSettingsLanguage+"/";""!==this.currentGameLanguage&&(t=this.currentGameLanguage+"/");let e=[],a=this.currentGameGuessingWordSet.data.map((async e=>{let a=e.toString().replace("./data/","./data/"+t);this.currentGameGuessingWordSet.noLanguage&&(a=e.toString().replace("./data/","./data/common/"));const s=await fetch(a);return await s.json()}));try{let t=await Promise.all(a);e=[].concat(...t)}catch(t){}return e},UpdateGameGuessesCount(t,e=!1){let a=this.GetUserStartedGame(t);a&&!a.solved&&(a.solved=e,a.guesses++,localStorage.setItem("dailyGames",JSON.stringify(this.appDataUserDailyGamesStarted))),this.UpdateDailyGameFromStartedGameData(a)},UpdateDailyGameFromStartedGameData(t){let e=this.appDataDailyGames.find((e=>e.key===t.key));e.guesses=t.guesses,e.solved=t.solved,e.solved&&this.SendGameStatsToServer(e)},async SendGameStatsToServer(t){const e=`https://empty-night-9bea.bigtentgames.workers.dev/${`id=${this.appDataPlayerCurrent.id}&key=${t.key}&guesses=${t.guesses}`}`;announce(e);try{const t=await fetch(e,{method:"GET",headers:{Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}});t.ok||(this.appStateIsGettingLast10Games=!1,error("Server error: "+t.status))}catch(t){}},IsCurrentGuessCorrect(){if(note("IsCurrentGuessCorrect() called"),4===this.getNumberOfCardsThatHaveBeenPlacedOnTray){this.currentGameGuessCount++;let t=[];this.appDataHints.forEach((e=>{t.push(e.value)}));let e=this.currentGameSolutionActual.split(":"),a=this.GetCurrentSolutionParamString().split(":"),s=[];for(let t=0;t<e.length;t+=3)for(let r=0;r<a.length;r+=3)if(e[t]===a[r]){s.push(a[r],a[r+1],a[r+2]);break}if(this.currentGameSolutionGuessing=s.join(":"),this.currentGameSolutionActual===this.currentGameSolutionGuessing&&this.RotateTray(8),this.getCurrentDaily&&this.UpdateGameGuessesCount(this.getCurrentDaily,this.currentGameSolutionActual===this.currentGameSolutionGuessing),s[1]!==e[1]){let t=this.appDataCards.find((t=>t.words.some((t=>t.id===parseInt(s[1])))));this.SwapCards(t,this.getFirstAvailableParkingSpot)}if(s[2]!==e[2]){let t=this.appDataCards.find((t=>t.words.some((t=>t.id===parseInt(s[2])))));this.SwapCards(t,this.getFirstAvailableParkingSpot)}if(s[10]!==e[10]){let t=this.appDataCards.find((t=>t.words.some((t=>t.id===parseInt(s[10])))));this.SwapCards(t,this.getFirstAvailableParkingSpot)}if(s[11]!==e[11]){let t=this.appDataCards.find((t=>t.words.some((t=>t.id===parseInt(s[11])))));this.SwapCards(t,this.getFirstAvailableParkingSpot)}return this.appDataMessage=this.GetMessageBasedOnTrayCount(!0,""),this.appStateShowNotification=!0,this.appDataTimeoutNotification=setTimeout((()=>{this.appStateShowNotification=!1}),1700),this.ScrollParking(null,"beginning"),!1}},async FillParkingLot(){note("FillParkingLot() called"),this.appDataPlayerCreator.id=this.appDataPlayerCurrent.id,this.appStateIsGuessing=!0;let t=[new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({})],e=0;this.currentGameSolutionActual=this.GetCurrentSolutionParamString(),this.appDataCards.concat(this.appDataCardsParked).forEach((t=>{t.id=this.appDataPlayerCurrent.value+e++,t.rotation=(1===getRandomInt(0,1)?1:-1)*getRandomInt(0,4)})),this.ResetCardsAfterRotation(!1),this.appDataCardsParked=this.appDataCards;let a=[];this.appDataCards.forEach((t=>{t.words.forEach((t=>{a.push(t)}))}));let s=await this.GetCurrentGameWordSet();if(5===this.currentGameGuessingCardCount&&(this.appDataCardsParked.push(new CardObject({words:getUniqueWords(s,4,getJustWords(a))})),UseDebug)){announce("HERE ARE THE CARD WORDS"),this.appDataCards.forEach((t=>{}));for(let t=this.appDataCardsParked.length-1;t>0;t--){let e=Math.floor(Math.random()*(t+1));[this.appDataCardsParked[t],this.appDataCardsParked[e]]=[this.appDataCardsParked[e],this.appDataCardsParked[t]]}}4===this.currentGameGuessingCardCount&&this.appDataCardsParked.push(new CardObject({})),this.appDataCardsParked.push(new CardObject({})),this.appDataCards=t,await this.ShareBoard(!1,!0),this.GetLast10GlobalCreatedGames()},async RestoreGame(t){note("RestoreGame() called");var e=new URLSearchParams(window.location.search);this.appDataPlayerSender.name=e.has("sendingName")?e.get("sendingName"):this.appDataPlayerSender.name,this.currentGameGuessersName=this.appDataPlayerSender.name,this.currentGameLanguage=e.has("lang")?e.get("lang"):"en-us",this.appDataPlayerCreator.name=e.has("puzzleName")?e.get("puzzleName"):this.appDataPlayerCreator.name,this.appDataPlayerSender.id=e.has("sendingID")?parseInt(e.get("sendingID")):this.appDataPlayerSender.id,this.appDataPlayerCreator.id=e.has("puzzleID")?parseInt(e.get("puzzleID")):this.appDataPlayerCreator.id,this.appCurrentDailyGameKey=e.has("key")?e.get("key").toString():this.appCurrentDailyGameKey,this.currentGameGuessingWordSet=e.has("wordSetID")?this.appDataWordSets.find((t=>t.id===e.get("wordSetID"))):this.currentGameWordSet,this.currentGameGuessingCardCount=e.has("useExtraCard")&&JSON.parse(e.get("useExtraCard"))?5:4,this.appStateForceAutoCheck=0===this.appDataPlayerCreator.id,this.appDataPlayerSender.id===this.appDataPlayerCreator.id||this.appDataPlayerCreator.id===this.appDataPlayerCurrent.id||this.appStateForceAutoCheck||(this.appStateIsModalShowing=!0,this.appDataConfirmationObject={message:"Are you, ("+this.appDataPlayerCreator.name+"), the original creator of this puzzle?",target:"creator"},this.appStateShowConfirmation=!0);let a=!1;if(t.length>=40){this.appDataShareURL=window.location.href;let s=await this.GetGuessingGameWordSet();this.appDataCards=[new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({})],this.appDataCardsParked=[new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({})],this.appDataHints=[new WordObject({}),new WordObject({}),new WordObject({}),new WordObject({})];let r=0;this.appDataCards.forEach((e=>{for(let i=0;i<4;i++){if(""!==t[r]){let i=s.find((e=>e.id===parseInt(t[r])));void 0===i&&(a=!0),e.words.push(i)}r++}})),this.appDataCardsParked.forEach((e=>{for(let i=0;i<4;i++){if(""!==t[r]){let i=s.find((e=>e.id===parseInt(t[r])));void 0===i&&(a=!0),e.words.push(i)}r++}})),this.appDataHints.forEach((e=>{e.value=t[r++]})),e.has("sol")?(this.currentGameSolutionActual=e.get("sol"),e.has("final")&&(this.currentGameSolutionGuessing=this.currentGameSolutionActual,this.appDataMessage=this.appDataPlayerCurrent.name+", here's the solution.",this.currentGameReviewIsFinal=!0)):this.currentGameSolutionActual=[],this.SetWordSetTheme(this.currentGameGuessingWordSet),this.documentCssRoot.style.setProperty("--wordScale",this.currentGameGuessingWordSet.scale),this.appDataPlayerCurrent.role=this.appDataPlayerCreator.id===this.appDataPlayerCurrent.id&&this.appDataPlayerCurrent.id!==this.appDataPlayerSender.id?"reviewer":"guesser"}this.appStateIsGuessing=!0,a&&this.NewGame(null,"ðŸ˜• - Something went wrong.")},async CreateCardsForPlayer(t){note("CreateCardsForPlayer() called");let e=await this.GetCurrentGameWordSet(),a=getUniqueWords(e);for(let t=0;t<4;t++){const e=new CardObject({position:t});3===t&&(e.position=2),2===t&&(e.position=3),e.words=a.slice(0+4*t,4+4*t),this.appDataCards.push(e)}},async GetAISolution(){let t,e;t=[],e=document.getElementsByTagName("word");for(let a=0;a<e.length;a++){const s=e[a];t.push(s.innerHTML)}t=t.join(","),highlight(t);const a=`https://divine-dream-3aa5.bigtentgames.workers.dev/?${encodeURIComponent(t)}`;try{const t=await fetch(a,{method:"GET",headers:{Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}});t.ok||(this.appStateIsGettingLast10Games=!1,error("Server error: "+t.status));const e=await t.text();this.SetAIHints(JSON.parse(e).result),this.FillParkingLot()}catch(t){UseDebug&&this.userSettingsUseExtraCard&&(payload=JSON.stringify({result:["1","2","3","4"]}),this.SetAIHints(JSON.parse(payload).result),this.FillParkingLot())}},SetAIHints(t){for(let e=0;e<this.appDataHints.length;e++){this.appDataHints[e].value=t[e]}},SelectWordSet(t,e){note("SelectWordSet() called"),null!==t&&(t.preventDefault(),t.stopPropagation()),this.tempWordSets.forEach((t=>{t.isSelected=!1})),e.isSelected=!0,this.documentCssRoot.style.setProperty("--wordScale",e.scale)},GetCurrentSolutionParamString(){note("GetCurrentSolutionParamString() called");let t=[];return this.appDataHints.forEach((t=>{t.value=t.value.trim()})),4===this.getNumberOfCardsThatHaveBeenPlacedOnTray&&(t.push(this.appDataHints[0].value),t.push(this.appDataCards[0].words[0].id),t.push(this.appDataCards[1].words[0].id),t.push(this.appDataHints[1].value),t.push(this.appDataCards[1].words[1].id),t.push(this.appDataCards[3].words[1].id),t.push(this.appDataHints[2].value),t.push(this.appDataCards[2].words[3].id),t.push(this.appDataCards[0].words[3].id),t.push(this.appDataHints[3].value),t.push(this.appDataCards[3].words[2].id),t.push(this.appDataCards[2].words[2].id)),t.join(":")},GetUniqueCardId(t){if(note("GetUniqueCardId() called"),0===t.length)return 0;let e="";t.forEach((t=>{e+=t.value.toLowerCase()})),e=e.split(""),e=e.sort(),e=e.join("");let a=0;for(let t=0;t<e.length;t++)a=(26*a+(e.charCodeAt(t)-"a".charCodeAt(0)+1))%1000000007;return a},CheckIfCardIsInTray(t){return note("CheckIfCardIsInTray() called"),!(!t.words||0===t.words.length)&&(this.appDataCards.forEach((e=>{if(this.GetUniqueCardId(e.words)===this.GetUniqueCardId(t.words))return!0})),!1)},async GetLast10GlobalCreatedGames(){if(window.location.href!==window.location.origin+"/generate.html?generated=true"){note("GetLast10GlobalCreatedGames() called"),this.appStateIsGettingLast10Games=!0,this.appDataGlobalCreatedGames=[];await fetch("https://worker-falling-frost-2926.bigtentgames.workers.dev/",{method:"GET",headers:{Host:window.location.hostname,Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}}).then((t=>(t.ok||(this.appStateIsGettingLast10Games=!1,error("Server error: "+t.status)),t.text()))).then((t=>{this.appDataGlobalCreatedGames=JSON.parse(t)})).catch((t=>{this.appStateIsGettingLast10Games=!1})),this.appStateIsGettingLast10Games=!1}},async GetDailyGames(){if(this.vsShowDaily&&window.location.href!==window.location.origin+"/generate.html?generated=true"){note("GetDailyGames() called"),this.appStateIsGettingLast10Games=!0,this.appDataDailyGames=[];await fetch("https://lucky-bread-acb4.bigtentgames.workers.dev/",{method:"GET",headers:{Host:window.location.hostname,Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}}).then((t=>(t.ok||(this.appStateIsGettingDailyGames=!1,error("Server error: "+t.status)),t.text()))).then((t=>{this.appDataDailyGames=JSON.parse(t);new Date;this.appDataDailyGames.forEach((t=>{let e=this.GetUserStartedGame(t);t.guesses=0,e&&(t.solved=e.solved,t.guesses=e.guesses)})),this.GetDailyGameStats()})).catch((t=>{this.appStateIsGettingDailyGames=!1})),this.appStateIsGettingDailyGames=!1}},async GetDailyGameStats(){await fetch("https://old-frog-73f3.bigtentgames.workers.dev/",{method:"GET",headers:{Host:window.location.hostname,Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}}).then((t=>(t.ok||(this.appStateIsGettingDailyGames=!1,error("Server error: "+t.status)),t.text()))).then((t=>{this.appDataDailyGamesStats=JSON.parse(t),this.appDataDailyGames.forEach((t=>{t.showStats=!1;for(const e of this.appDataDailyGamesStats)if(e.hasOwnProperty(t.key)){t.stats=e[t.key];break}}))})).catch((t=>{}))},HandleSubmitButtonPress(){note("HandleSubmitButtonPress() called"),"reviewer"===this.appDataPlayerCurrent.role&&4===this.getNumberOfCardsThatHaveBeenPlacedOnTray?(this.appStateIsModalShowing=!0,this.appDataConfirmationObject={message:"Did they have the right answer?",target:"correct"},this.appStateShowConfirmation=!0):this.appStateIsGuessing?this.currentGameSolutionGuessing===this.currentGameSolutionActual?this.getIsAIGenerated?this.ShareWin():this.HandleNewGameClick():this.getCurrentDaily||this.appStateForceAutoCheck?this.IsCurrentGuessCorrect():this.ShareBoard():this.FillParkingLot()},GetUserStartedGame(t){return this.appDataUserDailyGamesStarted.find((e=>e.key===t.key))},HasUserStartedGame(t){let e=!1;return e=!!this.GetUserStartedGame(t),e},HandleOldGameClick(t,e){note("HandleOldGameClick() called"),t.preventDefault(),t.stopPropagation();let a=["?"];if(this.currentGameSolutionGuessing="",this.appDataMessage="",a.push("sendingName=Player 1"),a.push("&generated="+encodeURIComponent(this.getIsAIGenerating?this.getIsAIGenerating:e.generated)),a.push("&key="+encodeURIComponent(e.key)),a.push("&puzzleName=Player 1"),a.push("&puzzleID="+encodeURIComponent(e.puzzleID)),a.push("&lang="+encodeURIComponent(e.lang)),a.push("&wordSetID="+encodeURIComponent(e.wordSetID)),a.push("&useExtraCard="+encodeURIComponent(e.useExtraCard)),a.push("&sol="+encodeURIComponent(e.sol)),a.push("&board="+encodeURIComponent(e.board)),this.appCurrentDailyGameKey=-1,e.date&&e.key){if(a.push("&key="+encodeURIComponent(e.key)),!this.HasUserStartedGame(e)){let t={key:e.key,guesses:0,solved:!1};this.appDataUserDailyGamesStarted.push(t),localStorage.setItem("dailyGames",JSON.stringify(this.appDataUserDailyGamesStarted))}this.appCurrentDailyGameKey=e.key}let s=a.join(""),r=location.origin+s;log(r),history.pushState(null,null,r),this.appStateShowDailyGames&&this.ToggleShowDailyGames(t),this.appStateShowMeta&&this.ToggleShowMeta(t),this.appStateShowGlobalCreated&&this.ToggleShowGlobalCreated(t),this.LoadPage(),this.appStateShowNotification=!0,this.RotateTray(-4)},HandleGoButtonClick(t){note("HandleGoButtonClick() called"),this.SubmitSettings(t),this.appStateShowCatChooser=!1},HandleNewGameClick(){note("HandleNewGameClick() called"),this.GetCategoryNames(),this.appStateShowCatChooser=!0},HandleYesNo(t,e){switch(t){case"correct":this.ShareBoard(e);break;case"newgame":e&&this.NewGame(null);break;case"creator":e&&(confirm=window.confirm(`Are you sure you are, (${this.appDataPlayerCreator.name}), the original creator?`),confirm&&(this.tempID=this.appDataPlayerCreator.id,this.appDataPlayerCurrent.id=this.appDataPlayerCreator.id,this.appDataPlayerCurrent.role="reviewer",localStorage.setItem("userID",this.appDataPlayerCurrent.id)));break;default:break}this.appStateShowConfirmation=!1,this.appStateIsModalShowing=!1},HandlePointerMoveEvent(t){t.clientX,this.appDataGhostX,t.clientY,this.appDataGhostY;this.appDataGhostX=t.clientX,this.appDataGhostY=t.clientY},HandleBodyPointerUp(t,e){note("HandleBodyPointerUp() called"),this.appStateIsModalShowing?this.appDataDraggedCard.isSelected=!1:(this.appStateIsDragging=!1,this.appDataDraggedCard=this.appDataEmptyCard)},HandleBodyPointerDown(t){this.appDataGhostX=t.clientX,this.appDataGhostY=t.clientY},HandleCardPointerDown(t,e){note("HandleCardPointerDown() called"),null!==t&&(t.preventDefault(),t.stopPropagation(),this.appDataGhostX=t.clientX,this.appDataGhostY=t.clientY,t.target.hasPointerCapture(t.pointerId)&&t.target.releasePointerCapture(t.pointerId)),this.appDataDraggedCard=e,this.appStateIsDragging=!0},HandleCardPointerUp(t,e){if(note("HandleCardPointerUp() called"),t.preventDefault(),t.stopPropagation(),this.appDataMessage="",this.getSelectedCard&&this.getSelectedCard===e)return this.appDataDraggedCard=this.appDataEmptyCard,void(this.appStateIsDragging=!1);this.appDataDraggedCard.words.length>0&&this.SwapCards(e,this.appDataDraggedCard)},ScrollParking(t,e){note("ScrollParking() called");const a=document.getElementById("parking"),s=parseInt(this.cssStyles.getPropertyValue("--cardSize")),r=parseFloat(this.cssStyles.getPropertyValue("--scale"));"left"===e?this.appDataParkingScrollLeft=a.scrollLeft+2*r*s:"right"===e?this.appDataParkingScrollLeft=a.scrollLeft-2*r*s:"beginning"===e&&(this.appDataParkingScrollLeft=0),a.scrollTo({left:this.appDataParkingScrollLeft,behavior:"smooth"}),setTimeout((()=>{this.appParkingRightButtonDisabled=a.scrollWidth-a.clientWidth<=a.scrollLeft}),300)},HandlePickerCardClicked(t,e){note("HandlePickerCardClicked() called"),t.preventDefault(),t.stopPropagation(),this.appDataMessage="",null===e&&(e=this.getFirstAvailableParkingSpot),this.SwapCards(e,this.appDataDraggedCard),this.appStateIsModalShowing=!1},HandlePageVisibilityChange(){let t=localStorage.getItem("userID");null!=t?(t=JSON.parse(t),this.appDataPlayerCurrent.id=t):(this.appDataPlayerCurrent.id=getRandomInt(1e7,1e8),localStorage.setItem("userID",this.appDataPlayerCurrent.id),this.appStateShowOOBE=""!==window.location.search),this.tempID=parseInt(this.appDataPlayerCurrent.id);let e=localStorage.getItem("dailyGames");null!=e&&(this.appDataUserDailyGamesStarted=JSON.parse(e));let a=localStorage.getItem("name");null!=a?this.appDataPlayerCurrent.name=a:(this.appStateIsModalShowing=!0,this.appStateShowIntro=!0,setTimeout((()=>{document.getElementById("nameInput").focus()}),410)),this.appDataWordSets.forEach((t=>{t.isSelected=!1}));let s=localStorage.getItem("wordSet");null!=s&&this.appDataWordSets.find((t=>t.id===s))?this.currentGameWordSet=this.appDataWordSets.find((t=>t.id===s)):this.currentGameWordSet=WordSets.find((t=>"100"===t.id)),this.currentGameWordSet.isSelected=!0;let r=localStorage.getItem("userSettingsLanguage");null!=r&&(this.userSettingsLanguage=r,this.tempUserSettingsLanguage=this.userSettingsLanguage);let i=localStorage.getItem("useWordSetThemes");null!=i&&(this.userSettingsUseWordSetThemes=JSON.parse(i),this.tempUseWordSetThemes=this.userSettingsUseWordSetThemes,this.SetWordSetTheme(this.currentGameWordSet)),this.appStateIsGuessing?this.documentCssRoot.style.setProperty("--wordScale",this.currentGameGuessingWordSet.scale):this.documentCssRoot.style.setProperty("--wordScale",this.currentGameWordSet.scale);let o=localStorage.getItem("useExtraCard");null!=o&&(this.userSettingsUseExtraCard=JSON.parse(o),this.tempUseExtraCard=this.userSettingsUseExtraCard);let n=localStorage.getItem("userSettingsUsesLightTheme");null!=n&&(this.ToggleUseLightTheme(JSON.parse(n)),this.tempUserSettingsUsesLightTheme=this.userSettingsUsesLightTheme);let p=localStorage.getItem("userSettingsUsesSimplifiedTheme");null!=p&&(this.ToggleUseSimplifedTheme(JSON.parse(p)),this.tempUserSettingsUsesSimplifiedTheme=this.userSettingsUsesSimplifiedTheme);let h=localStorage.getItem("useMultiColoredGems");null!=h&&(this.userSettingsUseMultiColoredGems=JSON.parse(h),this.tempUseMultiColoredGems=this.userSettingsUseMultiColoredGems)},CancelSettings(t){note("CancelSettings() called"),null!==t&&(t.preventDefault(),t.stopPropagation()),this.appStateIsModalShowing=!1,this.appStateShowSettings=!1,this.appStateShowIntro=!1,this.tempID=this.appDataPlayerCurrent.id,this.tempUseMultiColoredGems=this.userSettingsUseMultiColoredGems,this.tempUseWordSetThemes=this.userSettingsUseWordSetThemes,this.tempUserSettingsLanguage=this.userSettingsLanguage,this.tempUserSettingsUsesLightTheme=this.userSettingsUsesLightTheme,this.tempUseExtraCard=this.userSettingsUseExtraCard,this.tempUserSettingsUsesSimplifiedTheme=this.userSettingsUsesSimplifiedTheme},HandleIntroButtonClick(t){note("HandleIntroButtonClick() called"),this.SubmitSettings(null),this.appStateShowOOBE=!0},SubmitSettings(t){if(note("SubmitSettings() called"),null!==t&&(t.preventDefault(),t.stopPropagation()),this.appDataPlayerCurrent.name=""!==this.tempName?this.tempName.trim():this.appDataPlayerCurrent.name,this.appStateIsGuessing||(this.appDataPlayerCreator.name=this.appDataPlayerCurrent.name),localStorage.setItem("name",this.appDataPlayerCurrent.name),this.appStateShowSettings||this.appStateShowCatChooser){this.userSettingsLanguage=this.tempUserSettingsLanguage;let e=this.tempWordSets.find((t=>t.name===this.tempWordSetName));this.SelectWordSet(t,e);let a=!1;a=this.appDataWordSets.find((t=>!0===t.isSelected)).id!==this.tempWordSets.find((t=>!0===t.isSelected)).id,this.appDataWordSets=this.tempWordSets,this.currentGameWordSet=this.appDataWordSets.find((t=>!0===t.isSelected)),(a&&!this.appStateIsGuessing||this.appStateShowCatChooser)&&(this.NewGame(),this.SetWordSetTheme(this.currentGameGuessingWordSet)),this.appDataPlayerCurrent.id=this.tempID,this.userSettingsUseWordSetThemes=this.tempUseWordSetThemes,this.userSettingsUseExtraCard=this.tempUseExtraCard,this.ToggleUseLightTheme(this.tempUserSettingsUsesLightTheme),this.ToggleUseSimplifedTheme(this.tempUserSettingsUsesSimplifiedTheme),this.userSettingsUseMultiColoredGems=this.tempUseMultiColoredGems,this.currentGameGuessingCardCount=this.userSettingsUseExtraCard?5:4,this.SetWordSetTheme(this.currentGameGuessingWordSet),localStorage.setItem("userID",this.appDataPlayerCurrent.id),localStorage.setItem("useWordSetThemes",this.userSettingsUseWordSetThemes),localStorage.setItem("userSettingsLanguage",this.userSettingsLanguage),localStorage.setItem("userSettingsUsesLightTheme",this.userSettingsUsesLightTheme),localStorage.setItem("userSettingsUsesSimplifiedTheme",this.userSettingsUsesSimplifiedTheme),localStorage.setItem("useMultiColoredGems",this.userSettingsUseMultiColoredGems),localStorage.setItem("useExtraCard",this.userSettingsUseExtraCard),localStorage.setItem("wordSet",this.currentGameWordSet.id)}this.appStateIsModalShowing=!1,this.appStateShowSettings=!1,this.appStateShowIntro=!1},HandleShareGameButton(t,e,a){note("ShowSettings() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.ShareText(e,a)},HandleKeyDownEvent(t){if(!t.metaKey&&!t.ctrlKey&&!t.altKey)switch(t.key){case"Enter":note("HandleKeyDownEvent() called"),t.preventDefault(),this.appStateShowSettings||this.appStateShowTutorial||this.appStateShowIntro||this.appStateShowInfo||this.appStateShowConfirmation||this.appStateIsGuessing||4!==this.getNumberOfHintsThatHaveBeenFilled||this.FillParkingLot(),this.appStateShowSettings?this.SubmitSettings(t):this.appStateShowTutorial?(this.appStateShowOOBE=!1,this.ToggleShowTutorial(null)):this.appStateShowIntro?this.HandleIntroButtonClick(null):this.appStateShowConfirmation?this.HandleYesNo(this.appDataConfirmationObject.target,!0):this.appStateShowInfo?this.appStateShowInfo=!1:this.appStateShowGlobalCreated?this.appStateShowGlobalCreated=!1:this.appStateShowCatChooser&&this.HandleGoButtonClick(t);break;case"Tab":note("HandleKeyDownEvent() called"),t.preventDefault(),this.appStateTrayIsRotating||this.RotateTray(t.shiftKey?1:-1);break;case":":case"?":case"&":case"=":t.preventDefault(),t.stopPropagation();case"Escape":this.appStateShowOOBE=!1,this.appStateShowSettings?this.CancelSettings(null):this.appStateShowDailyGames?this.ToggleShowDailyGames(null):this.appStateShowTutorial?this.ToggleShowTutorial(null):this.appStateShowCatChooser?this.appStateShowCatChooser=!1:this.appStateShowConfirmation?this.HandleYesNo(this.appDataConfirmationObject.target,!1):this.appStateShowInfo?this.appStateShowInfo=!1:this.appStateShowGlobalCreated?this.appStateShowGlobalCreated=!1:this.appStateShowNotification?this.appStateShowNotification=!1:this.appStateShowMeta?this.appStateShowMeta=!1:this.appStateShowMeta||(this.appStateShowMeta=!0);break;default:}},HandleResize(){this.appStateUsePortraitLayout=document.body.offsetWidth/document.body.offsetHeight<.75},HandlePopState(){note("HandlePopState() called"),window.location.search?this.LoadPage():this.NewGame(null)},CheckForServiceWorkerUpdate(){note("CheckForServiceWorkerUpdate() called"),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(t){for(let e of t)e.update()}))},HandleServiceWorkerUnregistration(){"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(t){for(let e of t)e.unregister(),e.active.postMessage("SKIP_WAITING")}))},HandleServiceWorkerRegistration(){note("HandleServiceWorkerRegistration() called"),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then((t=>{t.addEventListener("updatefound",(()=>{this.serviceWorker=t.installing,this.serviceWorker.addEventListener("statechange",(()=>{switch(this.serviceWorker.state){case"installed":navigator.serviceWorker.controller&&(this.appStateIsNewVersionAvailable=!0);break}}))}))}))},ShareWin(){note("ShareWin() called");let t=this.getCurrentDaily&&this.getCurrentDaily===this.getTodaysDaily?"Today's":`The ${this.getCurrentDaily.date}`,e=`I solved ${t} Daily in ${this.getCurrentDaily.guesses} tries! ðŸ˜€ <https://facets.bigtentgames.com>`;this.ConstructAndSetShareURLForCurrentGame(),1===this.getCurrentDaily.guesses&&(e=`I solved ${t} Daily in 1 try! ðŸ¥³ <https://facets.bigtentgames.com>`),this.ShareText(e,"")},async CopyTextToClipboard(t){navigator.clipboard?window.ClipboardItem?await navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"})})]).then((()=>{note("Attempting to copy via navigator.clipboard.write"),this.appDataMessage="Message copied to the clipboard.",this.appStateShowNotification=!0})).catch((e=>{error("Failed to copy text via navigator.clipboard.write: ",e),this.CopyToClipboardViaExecCommand(t)})):await navigator.clipboard.writeText(t).then((()=>{note("Attempting to copy via navigator.clipboard.writeText"),this.appDataMessage="Message copied to the clipboard.",this.appStateShowNotification=!0})).catch((e=>{error("Failed to copy text via navigator.clipboard.writeText: ",e),this.CopyToClipboardViaExecCommand(t)})):this.CopyToClipboardViaExecCommand(t)},async CopyToClipboardViaExecCommand(t){note("CopyToClipboardViaExecCommand() called");copyToClipboard(t);this.appDataMessage=""},async ShareText(t,e){if(!this.getIsAIGenerating){note("ShareText() called"),this.appDataMessage="",note("_text = "+t),note("_url = "+e);let a={text:t+(""===e?"":" <"+e+">")};navigator.canShare&&!navigator.canShare(a)&&(a={text:t,url:""===e?window.location.origin:e}),navigator.share&&navigator.canShare(a)?await navigator.share(a).then((t=>{note("Message shared via navigator.share()")})).catch((a=>{this.CopyTextToClipboard(t+(""===e?"":" <"+e+">"))})):this.CopyTextToClipboard(t+(""===e?"":" <"+e+">"))}highlight("test")},async ShareBoard(t=!1,e=!1){if(note("ShareBoard() called"),!this.getIsAIGenerating&&this.isChromeAndiOSoriPadOS&&-1!==this.appDataShareURL.indexOf("facets.bigtentgames.com/game/?"))this.CopyTextToClipboard(this.GetShareTextBasedOnContext(t)+" <"+this.appDataShareURL+">"),note("Shortened URL exists, copying to clipboard");else{let s="reviewer"===this.appDataPlayerCurrent.role&&4===this.getNumberOfCardsThatHaveBeenPlacedOnTray,r=this.GetShareTextBasedOnContext(t);this.ConstructAndSetShareURLForCurrentGame(s,e),this.appStateIsGettingTinyURL=!0;var a=(this.getIsAIGenerating?"https://flat-night-eecc.bigtentgames.workers.dev/":"https://worker-winter-glade-cd02.bigtentgames.workers.dev/")+location.search.substring(1);note("Fetching short url"),await fetch(a,{method:"GET",headers:{Host:window.location.hostname,Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}}).then((t=>t.ok?(highlight("Success"),t.text()):t.text().then((t=>{const e=JSON.parse(t);error("("+e.statusCode+") "+e.message)})))).then((t=>this.appDataShareURL=location.origin+"/game/?"+t)).catch((t=>{})),this.appStateIsGettingTinyURL=!1,this.ShareText(r,this.appDataShareURL)}},ReportPuzzle(t){location.href="mailto:bigtentgames@icloud.com?subject=Facets Puzzle Reported&body=Puzzle ID# "+t.key+"%0D%0A This puzzle contains offensive language.%0D%0A"+t.hints},ConstructAndSetShareURLForCurrentGame(t,e=!1){if(note("ConstructAndSetShareURLForCurrentGame() called"),this.appStateIsGuessing){this.currentGameSolutionGuessing!==this.currentGameSolutionActual&&(this.currentGameSolutionGuessing="");let a="",s="";this.appDataCards.concat(this.appDataCardsParked).forEach((t=>{0===t.words.length&&(s+="::::"),t.words.forEach((t=>{s+=t.id+":"}))})),this.appDataHints.forEach(((t,e)=>{t.value=t.value.trim();let a=encodeURIComponent(t.value);s+=a+(e===this.appDataHints.length-1?"":":")})),a=encodeURIComponent(a),a+="?sendingName="+encodeURIComponent(this.appDataPlayerCurrent.name),a+="&generated="+encodeURIComponent(!!this.getCurrentDaily||this.getIsAIGenerating),this.getCurrentDaily&&(a+="&key="+encodeURIComponent(this.getCurrentDaily.key)),a+="&puzzleName="+encodeURIComponent(this.appDataPlayerCreator.name),a+="&puzzleID="+encodeURIComponent(this.appDataPlayerCreator.id),a+="&lang="+(!1===e?encodeURIComponent(this.currentGameLanguage):encodeURIComponent(this.userSettingsLanguage)),a+="&wordSetID="+encodeURIComponent(this.currentGameGuessingWordSet.id),e&&(a+="&isNew=true"),a+="&sendingID="+encodeURIComponent(this.appDataPlayerCurrent.id),a+="&useExtraCard="+encodeURIComponent(5===this.currentGameGuessingCardCount),a+="&sol="+encodeURIComponent(this.currentGameSolutionActual),t&&(a+="&final=true"),a=window.location.origin+window.location.pathname+a+"&board="+s,this.appDataShareURL=a,history.pushState(null,null,this.appDataShareURL)}},GetMessageBasedOnTrayCount(t,e){note("GetMessageBasedOnTrayCount() called");let a=this.getNumberOfCardsThatHaveBeenPlacedOnTray,s="";this.getNumberOfCardsThatHaveBeenPlacedOnTray<4&&(s=a+"/4 "),4!==a||"reviewer"!==this.appDataPlayerCurrent.role||t||(a=5);let r=LevelMessage[a][getRandomInt(0,LevelMessage[a].length)],i=""!==e,o=i?e+", ":"",n=i&&0!==r.indexOf("I ");r=n?r.charAt(0).toLowerCase()+r.slice(1):r;let p=s+LevelEmoji[a][getRandomInt(0,LevelEmoji[a].length)]+" "+o+r;return announce(p),p},GetShareTextBasedOnContext(t){note("GetShareTextBasedOnContext() called");let e="",a=this.currentGameGuessingWordSet.startsWithVowel?"an ":"a ";return a=5===this.currentGameGuessingCardCount?"a ":a,e=this.appDataPlayerCurrent.id===this.appDataPlayerSender.id&&this.appDataPlayerCurrent.id===this.appDataPlayerCreator.id?"ðŸ§ "+this.currentGameGuessingWordSet.emoji+(5===this.currentGameGuessingCardCount?"â­ï¸":"")+" I created "+a+(5===this.currentGameGuessingCardCount?"5-card ":"")+'"'+this.currentGameGuessingWordSet.name+'" word puzzle for you to solve!':"reviewer"===this.appDataPlayerCurrent.role?this.GetMessageBasedOnTrayCount(t,this.currentGameGuessersName):"ðŸ¤” "+this.appDataPlayerCreator.name+", here's my guess!",e},SwapCards(t,e){note("SwapCards() called");let a=new CardObject(t),s=new CardObject(e);t.words=s.words,t.rotation=s.rotation,t.isSelected=!1,t.justDropped=!0,e.words=a.words,e.rotation=a.rotation,e.isSelected=!1,e.justDropped=!0,setTimeout((()=>{this.appDataCards.concat(this.appDataCardsParked).forEach((t=>{t.justDropped=!1}))}),this.appDataTransitionLong),this.appStateIsDragging=!1,this.appDataDraggedCard=this.appDataEmptyCard,this.ConstructAndSetShareURLForCurrentGame()},HandleCardClick(t,e){note("HandleCardClick() called"),t.preventDefault(),t.stopPropagation(),this.ToggleCardSelection(e)},ToggleCardSelection(t){if(note("ToggleCardSelection() called"),this.getSelectedCard&&this.getSelectedCard!==t)return void this.SwapCards(this.getSelectedCard,t);let e=!t.isSelected;this.appDataCards.forEach((t=>{t.isSelected=!1,t.isInTray=!0,t.justDropped=!1})),this.appDataCardsParked.forEach((t=>{t.isSelected=!1,t.isInTray=!1,t.justDropped=!1})),t.isSelected=0!==t.words.length&&e,document.body.offsetHeight<=660&&!this.appStateIsModalShowing&&(this.appStateIsModalShowing=!0),t.isSelected&&(this.appDataDraggedCard=t)},ToggleGameShowStats(t){t.preventDefault(),t.stopPropagation(),this.appStateShowStats=!this.appStateShowStats},RotateCard(t,e,a){note("RotateCard() called"),t.preventDefault(),t.stopPropagation(),this.appDataTransitionShort=parseInt(getComputedStyle(document.body).getPropertyValue("--mediumTransition").replace("ms","")),this.appStateIsGuessing&&(!this.userSettingsFocus||this.userSettingsFocus&&"parking"!==t.target.parentElement.parentElement.id)&&(this.appDataMessage="",this.appDataTimeoutCardRotation&&(clearTimeout(this.appDataTimeoutCardRotation),this.appDataTimeoutCardRotation=null),e.isSelected=!1,e.rotation=e.rotation+a,e.isRotating=!0,this.appDataTimeoutCardRotation=setTimeout((()=>{this.ResetCardsAfterRotation()}),this.appDataTransitionShort))},ResetCardsAfterRotation(t=!0){note("ResetCardsAfterRotation() called"),this.appDataCards.concat(this.appDataCardsParked).forEach((t=>{if(0!==t.rotation){t.isRotating=!1;let e=t.words.length;if(e>0){let a=(t.rotation%e+e)%e;t.words=t.words.slice(-a).concat(t.words.slice(0,-a))}t.rotation=0}})),this.appStateIsGuessing&&t&&this.ConstructAndSetShareURLForCurrentGame()},RotateTrayBasedOnInputFocus(t){if(note("RotateTrayBasedOnInputFocus() called"),0!=t)switch(t){case 0:this.RotateTray(0);break;case 1:this.RotateTray(-1);break;case 2:this.RotateTray(1);break;case 3:this.RotateTray(-2);break}},RotateTray(t){note("RotateTray() called"),this.appStateTrayIsRotating||(this.appDataMessage="",this.appStateTrayIsRotating=!0,this.appDataTimeoutTrayRotation&&(clearTimeout(this.appDataTimeoutTrayRotation),this.appDataTimeoutTrayRotation=null),this.getSelectedCard&&(this.getSelectedCard.isSelected=!1),this.appStateTrayRotation=this.appStateTrayRotation+t,document.getElementById("parkingInput").focus(),this.appDataTimeoutTrayRotation=setTimeout((()=>{this.ResetTrayAfterRotation()}),this.appDataTransitionLong),this.appStateIsGuessing||setTimeout((()=>{let t=document.getElementById("hint0");this.appDataParkingInputValue="",t.focus()}),this.appDataTransitionLong))},ResetTrayAfterRotation(){if(note("ResetTrayAfterRotation() called"),this.appStateTrayIsRotating=!1,this.appDataParkingInputValue="",this.appStateTrayRotation<3){if(0!==this.appStateTrayRotation){let t=this.appDataHints.length;if(t>0){let e=(this.appStateTrayRotation%t+t)%t;this.appDataHints=this.appDataHints.slice(-e).concat(this.appDataHints.slice(0,-e))}}let t=this.appDataHints[0],e=this.appDataHints[1],a=this.appDataHints[2],s=this.appDataHints[3],r=this.appDataCards[0],i=this.appDataCards[1],o=this.appDataCards[2],n=this.appDataCards[3];switch(r.rotation=i.rotation=o.rotation=n.rotation=this.appStateTrayRotation,this.ResetCardsAfterRotation(!1),this.appStateTrayRotation){case-1:this.appDataHints[0]=t,this.appDataHints[1]=a,this.appDataHints[2]=s,this.appDataHints[3]=e,this.appDataCards[0]=i,this.appDataCards[2]=r,this.appDataCards[1]=n,this.appDataCards[3]=o;break;case 1:this.appDataHints[0]=s,this.appDataHints[1]=e,this.appDataHints[2]=t,this.appDataHints[3]=a,this.appDataCards[0]=o,this.appDataCards[1]=r,this.appDataCards[2]=n,this.appDataCards[3]=i;break;case 2:case-2:this.appDataHints[0]=e,this.appDataHints[1]=t,this.appDataHints[2]=s,this.appDataHints[3]=a,this.appDataCards[0]=n,this.appDataCards[1]=o,this.appDataCards[2]=i,this.appDataCards[3]=r;break;default:break}this.ConstructAndSetShareURLForCurrentGame()}this.appStateTrayRotation=0},GetScrollSize(){const t=document.getElementById("parking");return t.scrollWidth-t.clientWidth},ConvertToDateFromKey(t){let e=t.substring(2,4),a=t.substring(4,8),s=t.substring(0,2)-1;return new Date(a,s,e)},GetDateFormatted(t,e=!1){const a=e?0:1;let s=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+a).padStart(2,"0"),i=t.getFullYear(),o=r+s+i;if(e){let t=new Date(i,r,s),e={year:"numeric",month:"short",day:"numeric"};o=new Intl.DateTimeFormat(void 0,e).format(t)}return o},async NewGame(t,e="",a=!0){note("NewGame() called"),document.title="Facets!",this.appDataMessage=e,this.currentGameGuessCount=0,this.appCurrentDailyGameKey=-1,this.currentGameLanguage="",this.currentGameReviewIsFinal=!1,this.currentGameGuessersName="",this.appDataPlayerCurrent.role="creator",this.appDataPlayerCreator.id=this.appDataPlayerCurrent.id,this.appDataPlayerCreator.name=this.appDataPlayerCurrent.name,this.appDataPlayerSender.id=this.appDataPlayerCurrent.id,this.appDataPlayerSender.name=this.appDataPlayerCurrent.name,this.currentGameGuessingWordSet=this.currentGameWordSet,this.currentGameGuessingCardCount=this.userSettingsUseExtraCard?5:4,this.currentGameSolutionGuessing="",this.appStateTrayIsRotating=!1,this.appStateForceAutoCheck=!1,this.appStateShowMeta=!1,this.SetWordSetTheme(this.currentGameWordSet),this.appDataShareURL="",history.pushState(null,null,window.location.origin+window.location.pathname),this.appStateIsGuessing=!1,this.appDataCards=[],this.appDataCardsParked=[new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({})],this.appDataHints=[new WordObject({}),new WordObject({}),new WordObject({}),new WordObject({})],await this.CreateCardsForPlayer(null),a&&this.RotateTray(-4)},LoadPage(){note("LoadPage() called"),this.HandlePageVisibilityChange(),announce("Player "+this.appDataPlayerCurrent.id+" has loaded v"+this.appDataVersion),this.GetLast10GlobalCreatedGames(),this.GetDailyGames(),this.appDataTransitionLong=parseInt(getComputedStyle(document.body).getPropertyValue("--longTransition").replace("ms","")),this.appDataTransitionShort=parseInt(getComputedStyle(document.body).getPropertyValue("--shortTransition").replace("ms","")),this.appStatePageHasLoaded=!0;var t="";let e=[];try{if(window.location.search){t=new URLSearchParams(window.location.search),UseDebug=!!t.has("useDebug")||UseDebug,decodeURIComponent(window.location.search).split("?")[1].split("&"),e=t.has("board")?t.get("board").split(":"):[]}e.length>=40?(document.title="Facets!",this.RestoreGame(e)):this.appStateIsGuessing||(this.getIsAIGenerating&&(this.currentGameGuessingCardCount=getRandomInt(4,6),this.userSettingsUseExtraCard=5===this.currentGameGuessingCardCount,this.currentGameWordSet=this.getEnabledWordSets[getRandomInt(0,this.getEnabledWordSets.length)],log(this.currentGameWordSet.name),this.SelectWordSet(null,this.currentGameWordSet),note(this.currentGameWordSet.name),setTimeout((()=>{this.GetAISolution()}),100)),note(this.currentGameWordSet.name),this.NewGame(null,"",!1),highlight(this.currentGameWordSet.name))}catch(t){warn(t.message),e=[],this.NewGame(null,"ðŸ˜• - Something went wrong.",!1)}this.appStateUsePortraitLayout=document.body.offsetHeight>document.body.offsetWidth}},mounted(){this.HandleServiceWorkerUnregistration(),this.LoadPage(),window.addEventListener("keydown",this.HandleKeyDownEvent),window.addEventListener("pointermove",this.HandlePointerMoveEvent),window.addEventListener("visibilitychange",this.HandlePageVisibilityChange),window.addEventListener("resize",this.HandleResize),window.addEventListener("popstate",this.HandlePopState)},watch:{userSettingsLanguage:function(t,e){highlight("userSettingsLanguage watch triggered"),this.LoadTranslatedWords()}},computed:{getSelectedCard:function(){return this.appDataCards.concat(this.appDataCardsParked).find((t=>!0===t.isSelected))},getAllPlayerCards:function(t){return this.appDataCards.concat(this.appDataCardsParked).find((e=>e.id.indexOf(0===t)))},getAllCards:function(){let t=this.appDataCards.concat(this.appDataCardsParked).filter((t=>t.words.length>0));return t.forEach((t=>{t.id=this.GetUniqueCardId(t.words)})),t=t.sort(((t,e)=>t.id-e.id)),t},getFirstThreeParkedCards:function(){return this.appDataCardsParked.splice(0,3)},getNumberOfCardsThatHaveBeenPlacedOnTray:function(){return void 0===this.appDataCards?0:this.appDataCards.filter((t=>t.words.length>0)).length},getNumberOfHintsThatHaveBeenFilled:function(){return void 0===this.appDataHints?0:this.appDataHints.filter((t=>""!=t.value)).length},getUniqueCardId:function(t){return this.GetUniqueCardId(t)},getFirstAvailableParkingSpot:function(){return this.appDataCardsParked.find((t=>0===t.words.length))},getPlayerMessage:function(){clearTimeout(this.appDataTimeoutNotification);let t=3e3,e=this.currentGameGuessingWordSet.startsWithVowel?"an":"a",a=this.appStateForceAutoCheck?e:this.appDataPlayerCreator.name+"'s ",s="";if(""!==this.appDataMessage)s=this.appDataMessage;else if(this.appStateIsGuessing||-1===this.appDataPlayerCurrent.id)if(this.appDataPlayerCurrent.id===this.appDataPlayerSender.id&&-1!==this.appDataPlayerCurrent.id&&this.appDataPlayerCurrent.id===this.appDataPlayerCreator.id)s=`${this.appDataPlayerCurrent.name}, this is your own puzzle!`;else if(this.currentGameReviewIsFinal&&-1!==this.appDataPlayerCurrent.id)s=`${this.appDataPlayerCurrent.name}, here's the solution.`;else if(this.appDataPlayerCurrent.id!==this.appDataPlayerSender.id&&this.appDataPlayerCurrent.id===this.appDataPlayerCreator.id&&-1!==this.appDataPlayerCurrent.id)s=`You are reviewing ${this.appDataPlayerSender.name}'s guess!`;else if(this.getCurrentDaily){new Date;s=`<name>The Daily â€“ ${this.getCurrentDaily.date.split(",")[0]}</name><subtitle>Puzzle category â€“ "${this.currentGameGuessingWordSet.name}"</subtitle>`,this.getCurrentDaily.key===this.getTodaysDaily.key&&(s=`The Daily â€“ Today<subtitle>Puzzle category â€“  "${this.currentGameGuessingWordSet.name}"</subtitle>`)}else s=`You are guessing ${a} "${this.currentGameGuessingWordSet.name}" puzzle!`;else s=`You are creating a new "${this.currentGameGuessingWordSet.name}" puzzle!`,t=1700;return this.appDataTimeoutNotification=setTimeout((()=>{this.appStateShowNotification=!1}),t),s},getEnabledWordSets:function(){return this.appDataWordSets.filter((t=>t.enabled))},getEnabledTempWordSets:function(){return this.tempWordSets.filter((t=>t.enabled))},getEnabledTempWordSetNames:function(){let t=[];return this.appDataWordSets.forEach((e=>{e.enabled&&t.push(e.name)})),t.sort(((t,e)=>t.localeCompare(e,void 0,{sensitivity:"base"})))},getEnabledTempWordSet:function(){let t=[];return this.appDataWordSets.forEach((e=>{e.enabled&&t.push(e)})),t.sort(((t,e)=>t.name.localeCompare(e.name,void 0,{sensitivity:"base"})))},getEnabledTempLanguages:function(){let t=[];return this.appDataLanguages.forEach((e=>{e.enabled&&t.push({name:e.name,tag:e.tag})})),t.sort(((t,e)=>t.name.localeCompare(e.name,void 0,{sensitivity:"base"})))},getCurrentSelectedTempWordSetName:function(){return this.appDataWordSets.find((t=>t.isSelected)).name},getSubmitButtonText:function(){let t=this.appDataActionButtonTexts.check;return"reviewer"===this.appDataPlayerCurrent.role?t=this.appDataActionButtonTexts.respond:"creator"===this.appDataPlayerCurrent.role&&(t=this.appDataActionButtonTexts.send),this.appDataPlayerCurrent.id!==this.appDataPlayerCreator.id&&(this.appStateForceAutoCheck&&(this.getIsAIGenerated,t=this.appDataActionButtonTexts.guess),this.isChromeAndiOSoriPadOS&&this.appDataShareURL.includes("facets.bigtentgames.com/game/?")&&(t=this.appDataActionButtonTexts.copy),this.currentGameSolutionGuessing===this.currentGameSolutionActual&&(t=this.getCurrentDaily?this.appDataActionButtonTexts.share:this.appDataActionButtonTexts.create)),t},getCreatedGamesWithWordSetNames:function(){return this.appDataGlobalCreatedGames.map((t=>{const e=this.appDataWordSets.find((e=>e.id===t.wordSetID));return e?{...t,name:e.name}:t}))},getTodaysKey:function(){let t=new Date;return this.GetDateFormatted(t)},getTodaysDaily:function(){let t=new Date;return this.getDailyGamesWithWordSetNames.find((e=>e.key===this.GetDateFormatted(t)))},getCurrentDaily:function(){let t=this.getDailyGamesWithWordSetNames.find((t=>t.key===this.appCurrentDailyGameKey));return t||null},getDailyIsFreshToday:function(){return!(this.getTodaysDaily?this.HasUserStartedGame(this.getTodaysDaily):null)},getDailyGamesWithWordSetNames:function(){return this.appDataDailyGames.map((t=>{t.date=this.GetDateFormatted(this.ConvertToDateFromKey(t.key),!0);const e=this.appDataWordSets.find((e=>e.id===t.wordSetID));return e&&(t.name=e.name),t}))},isChromeAndiOSoriPadOS:function(){note("isChromeAndiOSoriPadOS() called");var t=navigator.userAgent||window.opera,e=/CriOS/.test(t)&&/iPhone|iPad|iPod/.test(t);return t=t.toLowerCase(),e||t.includes("firefox")&&t.includes("android")},getIsAIGenerating:function(){return-1!==window.location.href.indexOf(window.location.origin+"/generate.html")},getIsAIGenerated:function(){if(note("getIsAIGenerated() called"),window.location.search){let t=new URLSearchParams(window.location.search);return t.has("generated")&&"true"===t.get("generated").toString()}return!1},getActionButtonState:function(){return 4!==this.getNumberOfHintsThatHaveBeenFilled&&"creator"===this.appDataPlayerCurrent.role||4!==this.getNumberOfCardsThatHaveBeenPlacedOnTray&&"reviewer"!==this.appDataPlayerCurrent.role&&this.appDataPlayerCurrent.id!==this.appDataPlayerCreator.id},getCorrectCalIconClass:function(){let t=this.getCurrentDaily.date,e=parseInt(t.split(" ")[1]);const a=new Date;let s=new Date(a.getFullYear(),a.getMonth()+1,0).getDate()/12;return`cal${Math.ceil(e/s)}`}}});