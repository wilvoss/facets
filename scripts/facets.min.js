Vue.config.devtools=!1,Vue.config.silent=!0,Vue.config.ignoredElements=["app","preload","notification","message","icon","subtitle","badge","modal","controls","hider","confirmation","checkbox","toggle","legal","credit","version","categories","category","leftright","small","callout","instructions","gamelinks","gamelink","stats","stat","value","flogo","count","rotators","ghost","card","words","word","parking","spot","tray","diamond","hints","hint","cards","cta","dot","clues"];var app=new Vue({el:"#app",data:{appDataVersion:"2.1.53",appDataActionButtonTexts:{send:"Send",guess:"Guess",reply:"Reply",copy:"Copy",respond:"Respond",create:"Create",share:"Share",quit:"Give up"},appDataCards:[],appDataCardsParked:[],appDataLanguages:AllLanguages,appDataConfirmationObject:{message:"Did they have the right answer?",target:"correct"},appDataDraggedCard:new CardObject({}),appDataDraggedCardStartedInParkingLot:!1,appDataEmptyCard:new CardObject({id:"ghost"}),appDataGameCatchphrase:"A Puzzle Game of Words and Wits!",appDataGameName:"Facets",appDataGhostX:0,appDataGhostY:0,appDataParkingScrollLeft:0,appDataGlobalCreatedGames:[],appDataDailyGames:[],appDataUserDailyGamesStarted:[],appDataHints:[],appDataMessage:"",appDataParkingInputValue:"",appDataPlayerCurrent:new PlayerObject({}),appDataPlayerCreator:new PlayerObject({}),appDataPlayerSender:new PlayerObject({}),appDataShareURL:"",appDataTimeoutCardRotation:null,appDataTimeoutTrayRotation:null,appDataTimeoutNotification:null,appDataTransitionLong:0,appDataTransitionShort:0,appDataWordSets:[...WordSets],appCurrentDailyGameKey:-1,appDailyIsFreshToday:!0,appDataNumberOfNewDailies:1,appDataDailyGamesStats:[],appDataInc:0,appStateForceAutoCheck:!1,appStateIsDragging:!1,appStateIsGettingTinyURL:!1,appStateIsGettingLast10Games:!1,appStateIsGettingDailyGames:!1,appStateIsGettingDailyGameStats:!1,appStateIsGettingUserStats:!1,appStateSolving:!1,appStateIsGuessing:!1,appStateIsModalShowing:!1,appStateIsNewVersionAvailable:!1,appStatePageHasLoaded:!1,appStateShowCatChooser:!1,appStateShowConfirmation:!1,appStateShowGlobalCreated:!1,appStateShowDailyGames:!1,appStateShowInfo:!1,appStateShowIntro:!1,appStateShowOOBE:!1,appStateShowStats:!1,appStateShowSettings:!1,appStateShowTutorial:!1,appStateTrayIsRotating:!1,appStateTrayRotation:0,appStateUseNotifications:UseDebug,appStateUsePortraitLayout:!1,appStateShowNotification:!1,appParkingRightButtonDisabled:!1,appStateShowMeta:!0,vsShowDaily:!0,appStateUseFlower:!1,appStateBrowserNotificationInterval:null,appStateShareError:!1,currentGameGuessCount:0,currentGameGuessersName:"",currentGameLanguage:"",currentGameGuessingCardCount:4,currentGameGuessingWordSet:WordSets.find((t=>"100"===t.id)),currentGameReviewIsFinal:!1,currentGameSolutionActual:"",currentGameSolutionGuessing:[],currentGameWordSet:WordSets.find((t=>"100"===t.id)),userSettingsUseExtraCard:!1,userSettingsUsesLightTheme:!1,userSettingsUsesSimplifiedTheme:!1,userSettingsUseMultiColoredGems:!0,userSettingsUseWordSetThemes:!0,userSettingsUserWantsDailyReminder:!1,userSettingsShowAllCards:!1,userSettingsStreaks:[],vsUseFocus:!0,userSettingsLanguage:"en-us",userSettingsLegalAccepted:!1,tempName:"",tempID:0,tempShareURLCode:"",tempUseMultiColoredGems:!0,tempUserSettingsUsesLightTheme:!1,tempUserSettingsUsesSimplifiedTheme:!1,tempUserSettingsShowAllCards:!1,tempUseWordSetThemes:!0,tempUserWantsDailyReminder:!1,tempWordSetName:"",tempUsePortraitLayout:!1,tempUseExtraCard:!1,tempWordSets:[],tempUserSettingsLanguage:"en-us",documentCssRoot:document.querySelector(":root"),cssStyles:window.getComputedStyle(document.querySelector(":root"))},methods:{ToggleShowTutorial(t){note("ToggleShowTutorial() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateShowTutorial=!this.appStateShowTutorial},ToggleUseLightTheme(t){note("ToggleUseLightTheme() called"),this.userSettingsUsesLightTheme=t,this.userSettingsUsesLightTheme?document.getElementById("themeColor").content="hsl(140, 100%, 92%)":document.getElementById("themeColor").content="hsl(215, 100%, 3%)"},ToggleUseSimplifedTheme(t){note("ToggleUseSimplifedTheme() called"),this.userSettingsUsesSimplifiedTheme=t,this.userSettingsUsesSimplifiedTheme&&(this.tempUseMultiColoredGems=!0)},ToggleShowAllCards(t){note("ToggleShowAllCards() called"),this.userSettingsShowAllCards=t},ToggleFocus(){note("ToggleFocus() called"),window.innerWidth<=660&&(this.vsUseFocus=!this.vsUseFocus)},async ToggleShowGlobalCreated(t){note("ToggleShowGlobalCreated() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateShowGlobalCreated=!this.appStateShowGlobalCreated,0===this.appDataGlobalCreatedGames.length&&this.GetLast10GlobalCreatedGames()},async ToggleShowDailyGames(t){note("ToggleShowDailyGames() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateShowDailyGames=!this.appStateShowDailyGames,this.appStateShowDailyGames&&this.GetDailyGameStats()},ToggleShowInfo(t){note("ToggleShowInfo() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateShowInfo=!this.appStateShowInfo},ToggleShowMeta(t){note("ToggleShowMeta() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateShowMeta=!this.appStateShowMeta},SetTempLanguage(t){note("SetTempLanguage() called"),this.tempUserSettingsLanguage=t},ToggleTempUseWordSetThemes(){note("ToggleTempUseWordSetThemes() called"),this.tempUseWordSetThemes=!this.tempUseWordSetThemes},async ToggleTempUserWantsDailyReminder(){if(note("ToggleTempUserWantsDailyReminder() called"),this.tempUserWantsDailyReminder=!this.tempUserWantsDailyReminder,this.tempUserWantsDailyReminder&&this.isNotificationSupported){let t=await this.EnableDailyReminders();this.userSettingsUserWantsDailyReminder=this.tempUserWantsDailyReminder=!!t}},ToggleTempUseLightTheme(){note("ToggleTempUseLightTheme() called"),this.tempUserSettingsUsesLightTheme=!this.tempUserSettingsUsesLightTheme},ToggleTempUseSimplifiedTheme(){note("ToggleTempUseSimplifiedTheme() called"),this.tempUserSettingsUsesSimplifiedTheme=!this.tempUserSettingsUsesSimplifiedTheme},ToggleTempShowAllCards(){note("ToggleTempShowAllCards() called"),this.tempUserSettingsShowAllCards=!this.tempUserSettingsShowAllCards},ToggleTempUsePortraitLayout(){note("ToggleTempUsePortraitLayout() called"),this.tempUsePortraitLayout=!this.tempUsePortraitLayout},ToggleTempUseMultiColoredGems(){note("ToggleTempUseMultiColoredGems() called"),this.tempUseMultiColoredGems=!this.tempUseMultiColoredGems},ToggleTempUseExtraCard(){note("ToggleTempâ‰ˆUseExtraCard() called"),this.tempUseExtraCard=!this.tempUseExtraCard},ShowCategoryPicker(){note("ShowCategoryPicker() called"),this.tempWordSetName=this.getCurrentSelectedTempWordSetName},ShowSettings(t){note("ShowSettings() called"),null!=t&&(t.stopPropagation(),t.preventDefault()),this.appStateIsModalShowing=!0,this.appStateShowSettings=!0,this.GetCategoryNames()},GetCategoryNames(){this.tempWordSets=[],this.tempWordSetName=this.getCurrentSelectedTempWordSetName,this.appDataWordSets.forEach((t=>{this.tempWordSets.push(new WordSetObject(t))})),this.tempName=this.appDataPlayerCurrent.name},SetWordSetTheme(t){if(note("SetWordSetTheme() called"),this.userSettingsUseWordSetThemes)this.documentCssRoot.style.setProperty("--texture2","url("+t.textureImage+")"),this.documentCssRoot.style.setProperty("--textureSize",t.textureSize),this.documentCssRoot.style.setProperty("--textureBlendMode",t.textureBlendMode),this.documentCssRoot.style.setProperty("--textureHue",t.textureHue);else{let t=this.documentCssRoot.style.getPropertyValue("--textureSource");this.documentCssRoot.style.setProperty("--texture2",t),this.documentCssRoot.style.setProperty("--textureSize","cover"),this.documentCssRoot.style.setProperty("--textureBlendMode","normal");let e=this.documentCssRoot.style.getPropertyValue("--textureHueSource");this.documentCssRoot.style.setProperty("--textureHue",e)}this.documentCssRoot.style.setProperty("--wordScale",t.scale)},async LoadTranslatedWords(){note("LoadTranslatedWords() called");let t=await this.GetCurrentGameWordSet(),e={};t.forEach((t=>{e[t.id]=t})),this.appDataCards.forEach((t=>{t.words.forEach((t=>{e[t.id]&&(t.value=e[t.id].value)}))})),this.appDataCardsParked.forEach((t=>{t.words.forEach((t=>{e[t.id]&&(t.value=e[t.id].value)}))}))},async GetCurrentGameWordSet(){note("GetCurrentGameWordSet() called");let t=[],e=""===this.userSettingsLanguage?"":this.userSettingsLanguage+"/";""!==this.currentGameLanguage&&(e=this.currentGameLanguage);let a=this.currentGameWordSet.data.map((async t=>{let a=t.toString().replace("./data/","./data/"+e);this.currentGameWordSet.noLanguage&&(a=t.toString().replace("./data/","./data/common/"));const s=await fetch(a);return await s.json()}));try{let e=await Promise.all(a);t=[].concat(...e)}catch(t){error(t)}return t},async GetGuessingGameWordSet(){note("GetGuessingGameWordSet() called");let t=""===this.userSettingsLanguage?"":this.userSettingsLanguage+"/";""!==this.currentGameLanguage&&(t=this.currentGameLanguage+"/");let e=[],a=this.currentGameGuessingWordSet.data.map((async e=>{let a=e.toString().replace("./data/","./data/"+t);this.currentGameGuessingWordSet.noLanguage&&(a=e.toString().replace("./data/","./data/common/"));const s=await fetch(a);return await s.json()}));try{let t=await Promise.all(a);e=[].concat(...t)}catch(t){error(t)}return e},UpdateGameGuessesCount(t,e=!1){note("UpdateGameGuessesCount() called");let a=this.GetUserStartedGame(t);a&&!a.solved&&(a.solved=e,this.getCurrentDaily.quit?a.quit=!0:a.guesses++,localStorage.setItem("dailyGames",JSON.stringify(this.appDataUserDailyGamesStarted))),this.UpdateDailyGameFromStartedGameData(a)},async UpdateDailyGameFromStartedGameData(t){note("UpdateDailyGameFromStartedGameData() called");let e=this.appDataDailyGames.find((e=>e.key===t.key));e.guesses=t.guesses,e.solved=t.solved,this.getCurrentDaily.quit&&(e.quit=!0),e.solved&&await this.SendGameStatsToServer(e)},async SendGameStatsToServer(t){if(!this.appStateSolving){note("SendGameStatsToServer() called");let e=`id=${this.appDataPlayerCurrent.id}&key=${t.key}&guesses=${t.guesses}`;t.quit&&(e=`id=${this.appDataPlayerCurrent.id}&key=${t.key}&guesses=${t.guesses}&quit=true`);const a=`https://empty-night-9bea.bigtentgames.workers.dev/${e}`;await fetch(a,{method:"GET",headers:{Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}}).then((t=>(t.ok||error(t.status),t.json()))).catch((t=>{error(t)})).finally((()=>{this.GetDailyGameStats()}))}},IsCurrentGuessCorrect(){if(note("IsCurrentGuessCorrect() called"),4===this.getNumberOfCardsThatHaveBeenPlacedOnTray){this.currentGameGuessCount++;let t=[];this.appDataHints.forEach((e=>{t.push(e.value)}));let e=this.currentGameSolutionActual.split(":"),a=this.GetCurrentSolutionParamString().split(":"),s=[];for(let t=0;t<e.length;t+=3)for(let i=0;i<a.length;i+=3)if(e[t]===a[i]){s.push(a[i],a[i+1],a[i+2]);break}if(this.currentGameSolutionGuessing=s.join(":"),this.currentGameSolutionActual===this.currentGameSolutionGuessing&&(this.RotateTray(8),window.history.pushState({},document.title,window.location.pathname)),this.getCurrentDaily&&this.UpdateGameGuessesCount(this.getCurrentDaily,this.currentGameSolutionActual===this.currentGameSolutionGuessing),s[1]!==e[1]){let t=this.appDataCards.find((t=>t.words.some((t=>t.id===parseInt(s[1])))));this.SwapCards(t,this.getFirstAvailableParkingSpot)}if(s[2]!==e[2]){let t=this.appDataCards.find((t=>t.words.some((t=>t.id===parseInt(s[2])))));this.SwapCards(t,this.getFirstAvailableParkingSpot)}if(s[10]!==e[10]){let t=this.appDataCards.find((t=>t.words.some((t=>t.id===parseInt(s[10])))));this.SwapCards(t,this.getFirstAvailableParkingSpot)}if(s[11]!==e[11]){let t=this.appDataCards.find((t=>t.words.some((t=>t.id===parseInt(s[11])))));this.SwapCards(t,this.getFirstAvailableParkingSpot)}return this.appDataMessage=this.GetMessageBasedOnTrayCount(!0,""),this.appStateShowNotification=!0,this.appDataTimeoutNotification=setTimeout((()=>{this.appStateShowNotification=!1}),1700),this.ScrollParking(null,"beginning"),!1}},async FillParkingLot(){note("FillParkingLot() called"),this.appDataPlayerCreator.id=this.appDataPlayerCurrent.id,this.appStateIsGuessing=!0;let t=[new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({})],e=0;this.currentGameSolutionActual=this.GetCurrentSolutionParamString(),this.appDataCards.concat(this.appDataCardsParked).forEach((t=>{t.id=this.appDataPlayerCurrent.value+e++,t.rotation=(1===getRandomInt(0,1)?1:-1)*getRandomInt(0,4)})),this.ResetCardsAfterRotation(!1),this.appDataCardsParked=this.appDataCards;let a=[];this.appDataCards.forEach((t=>{t.words.forEach((t=>{a.push(t)}))}));let s=await this.GetCurrentGameWordSet();if(5===this.currentGameGuessingCardCount&&(this.appDataCardsParked.push(new CardObject({words:getUniqueWords(s,4,getJustWords(a))})),UseDebug)){announce("HERE ARE THE CARD WORDS"),this.appDataCards.forEach((t=>{log(JSON.stringify(t.words))}));for(let t=this.appDataCardsParked.length-1;t>0;t--){let e=Math.floor(Math.random()*(t+1));[this.appDataCardsParked[t],this.appDataCardsParked[e]]=[this.appDataCardsParked[e],this.appDataCardsParked[t]]}}4===this.currentGameGuessingCardCount&&this.appDataCardsParked.push(new CardObject({})),this.appDataCardsParked.push(new CardObject({})),this.appDataCards=t,await this.ShareBoard(!1,!0),this.GetLast10GlobalCreatedGames()},async RestoreGame(t){note("RestoreGame() called");var e=new URLSearchParams(window.location.search);this.appDataPlayerSender.name=e.has("sendingName")?e.get("sendingName"):this.appDataPlayerSender.name,this.currentGameGuessersName=this.appDataPlayerSender.name,this.currentGameLanguage=e.has("lang")?e.get("lang"):"en-us",this.appDataPlayerCreator.name=e.has("puzzleName")?e.get("puzzleName"):this.appDataPlayerCreator.name,this.appDataPlayerSender.id=e.has("sendingID")?parseInt(e.get("sendingID")):this.appDataPlayerSender.id,this.appDataPlayerCreator.id=e.has("puzzleID")?parseInt(e.get("puzzleID")):this.appDataPlayerCreator.id,this.appCurrentDailyGameKey=e.has("key")?e.get("key").toString():this.appCurrentDailyGameKey,this.currentGameGuessingWordSet=e.has("wordSetID")?this.appDataWordSets.find((t=>t.id===e.get("wordSetID"))):this.currentGameWordSet,this.currentGameGuessingCardCount=e.has("useExtraCard")&&JSON.parse(e.get("useExtraCard"))?5:4,this.appStateForceAutoCheck=0===this.appDataPlayerCreator.id,this.appDataPlayerSender.id===this.appDataPlayerCreator.id||this.appDataPlayerCreator.id===this.appDataPlayerCurrent.id||this.appStateForceAutoCheck||(this.appStateIsModalShowing=!0,this.appDataConfirmationObject={message:`Are you "${this.appDataPlayerCreator.name}," the original creator of this puzzle?`,target:"creator"},this.appStateShowConfirmation=!0);let a=!1;if(t.length>=40){this.appDataShareURL=window.location.href;let s=await this.GetGuessingGameWordSet();this.appDataCards=[new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({})],this.appDataCardsParked=[new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({})],this.appDataHints=[new WordObject({}),new WordObject({}),new WordObject({}),new WordObject({})];let i=0;this.appDataCards.forEach((e=>{for(let r=0;r<4;r++){if(""!==t[i]){let r=s.find((e=>e.id===parseInt(t[i])));void 0===r&&(a=!0),e.words.push(r)}i++}})),this.appDataCardsParked.forEach((e=>{for(let r=0;r<4;r++){if(""!==t[i]){let r=s.find((e=>e.id===parseInt(t[i])));void 0===r&&(a=!0),e.words.push(r)}i++}})),this.appDataHints.forEach((e=>{e.value=t[i++]})),e.has("sol")?(this.currentGameSolutionActual=e.get("sol"),e.has("final")&&(this.currentGameSolutionGuessing=this.currentGameSolutionActual,this.appDataMessage=`${this.appDataPlayerCurrent.name}, here's the solution to ${this.appDataPlayerSender.name}'s puzzle.`,this.currentGameReviewIsFinal=!0)):this.currentGameSolutionActual=[],this.SetWordSetTheme(this.currentGameGuessingWordSet),this.documentCssRoot.style.setProperty("--wordScale",this.currentGameGuessingWordSet.scale),this.appDataPlayerCurrent.role=this.appDataPlayerCreator.id===this.appDataPlayerCurrent.id&&this.appDataPlayerCurrent.id!==this.appDataPlayerSender.id?"reviewer":"guesser"}this.appStateIsGuessing=!0,a&&this.NewGame(null,"ðŸ˜• - Something went wrong.")},async CreateCardsForPlayer(t){note("CreateCardsForPlayer() called");let e=await this.GetCurrentGameWordSet(),a=getUniqueWords(e);for(let t=0;t<4;t++){const e=new CardObject({position:t});3===t&&(e.position=2),2===t&&(e.position=3),e.words=a.slice(0+4*t,4+4*t),this.appDataCards.push(e)}},async GetAISolution(){let t,e;note("GetAISolution() called"),t=[],e=document.getElementsByTagName("word");for(let a=0;a<e.length;a++){const s=e[a];t.push(s.innerHTML)}t=t.join(",");const a=`https://divine-dream-3aa5.bigtentgames.workers.dev/?${encodeURIComponent(t)}`;try{const t=await fetch(a,{method:"GET",headers:{Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}});t.ok||error(t.status);const e=await t.text();this.SetAIHints(JSON.parse(e).result),this.FillParkingLot()}catch(t){error(t),UseDebug&&this.userSettingsUseExtraCard&&(payload=JSON.stringify({result:["1","2","3","4"]}),this.SetAIHints(JSON.parse(payload).result),this.FillParkingLot())}this.ToggleShowMeta(null)},SetAIHints(t){note("SetAIHints() called");for(let e=0;e<this.appDataHints.length;e++){this.appDataHints[e].value=t[e]}},SelectWordSet(t,e){note("SelectWordSet() called"),null!==t&&(t.preventDefault(),t.stopPropagation()),this.tempWordSets.forEach((t=>{t.isSelected=!1})),e.isSelected=!0,this.documentCssRoot.style.setProperty("--wordScale",e.scale)},GetCurrentSolutionParamString(){note("GetCurrentSolutionParamString() called");let t=[];return this.appDataHints.forEach((t=>{t.value=t.value.trim()})),4===this.getNumberOfCardsThatHaveBeenPlacedOnTray&&(t.push(this.appDataHints[0].value),t.push(this.appDataCards[0].words[0].id),t.push(this.appDataCards[1].words[0].id),t.push(this.appDataHints[1].value),t.push(this.appDataCards[1].words[1].id),t.push(this.appDataCards[3].words[1].id),t.push(this.appDataHints[2].value),t.push(this.appDataCards[2].words[3].id),t.push(this.appDataCards[0].words[3].id),t.push(this.appDataHints[3].value),t.push(this.appDataCards[3].words[2].id),t.push(this.appDataCards[2].words[2].id)),t.join(":")},GetUniqueCardId(t){if(note("GetUniqueCardId() called"),0===t.length)return 0;let e="";t.forEach((t=>{e+=t.value.toLowerCase()})),e=e.split(""),e=e.sort(),e=e.join("");let a=0;for(let t=0;t<e.length;t++)a=(26*a+(e.charCodeAt(t)-"a".charCodeAt(0)+1))%1000000007;return a},CheckIfCardIsInTray(t){return note("CheckIfCardIsInTray() called"),!(!t.words||0===t.words.length)&&(this.appDataCards.forEach((e=>{if(this.GetUniqueCardId(e.words)===this.GetUniqueCardId(t.words))return!0})),!1)},async GetLast10GlobalCreatedGames(){if(!this.appStateIsGettingLast10Games&&(note("GetLast10GlobalCreatedGames() called"),window.location.href!==window.location.origin+"/generate.html?generated=true")){this.appStateIsGettingLast10Games=!0,this.appDataGlobalCreatedGames=[];await fetch("https://worker-falling-frost-2926.bigtentgames.workers.dev/",{method:"GET",headers:{Host:window.location.hostname,Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}}).then((t=>(t.ok||error(t.status),t.text()))).then((t=>{this.appDataGlobalCreatedGames=JSON.parse(t)})).catch((t=>{error(t)})).finally((()=>{this.appStateIsGettingLast10Games=!1}))}},async GetDailyGames(){if(!this.appStateIsGettingDailyGames&&(note("GetDailyGames() called"),this.vsShowDaily&&window.location.href!==window.location.origin+"/generate.html?generated=true")){this.appStateIsGettingDailyGames=!0,this.appStateIsGettingUserStats=!0,this.appDataDailyGames=[];await fetch("https://lucky-bread-acb4.bigtentgames.workers.dev/",{method:"GET",headers:{Host:window.location.hostname,Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}}).then((t=>(t.ok||error(t.status),t.text()))).then((t=>{this.appDataDailyGames=JSON.parse(t);new Date;this.appDataDailyGames.forEach((t=>{let e=this.GetUserStartedGame(t);t.guesses=0,e&&(t.solved=e.solved,t.guesses=e.guesses,e.quit&&(t.quit=e.quit))})),this.GetDailyGameStats()})).catch((t=>{error(t)})).finally((()=>{this.appStateIsGettingDailyGames=!1}))}},async GetDailyGameStats(){if(!this.appStateIsGettingDailyGameStats){note("GetDailyGameStats() called"),this.appStateIsGettingDailyGameStats=!0;await fetch("https://old-frog-73f3.bigtentgames.workers.dev/",{method:"GET",headers:{Host:window.location.hostname,Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}}).then((t=>(t.ok||error(t.status),t.text()))).then((t=>{this.appDataDailyGamesStats=JSON.parse(t),this.appDataDailyGames.forEach((t=>{t.showStats=!1,t.stats={avg:0,guesscounts:{beyond2:0}};for(const e of this.appDataDailyGamesStats)if(e.hasOwnProperty(t.key)){t.stats=e[t.key];break}}))})).catch((t=>{error(t)})).finally((()=>{this.GetUsersStats(),this.appStateIsGettingDailyGameStats=!1}))}},async GetUsersStats(){note("GetUsersStats() called"),this.appStateIsGettingUserStats=!0;var t="https://calm-glitter-d861.bigtentgames.workers.dev/"+this.appDataPlayerCurrent.id;await fetch(t,{method:"GET",headers:{Host:window.location.hostname,Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}}).then((t=>(t.ok||error(t.status),t.text()))).then((t=>{let e=JSON.parse(t);for(const t of this.appDataDailyGames)Vue.set(t,"guesses",0),Vue.set(t,"quit",!1);e.forEach((t=>{for(const e of this.appDataDailyGames)t.key===e.key&&(Vue.set(e,"guesses",t.guesses),Vue.set(e,"quit",t.quit),Vue.set(e,"solved",!0))}))})).catch((t=>{error(t)})).finally((()=>{this.appStateIsGettingUserStats=!1}))},HandleSubmitButtonPress(){note("HandleSubmitButtonPress() called"),"reviewer"===this.appDataPlayerCurrent.role&&4===this.getNumberOfCardsThatHaveBeenPlacedOnTray?(this.appStateIsModalShowing=!0,this.appDataConfirmationObject={message:`Did ${this.appDataPlayerSender.name} have the right answer?`,target:"correct"},this.appStateShowConfirmation=!0):this.appStateIsGuessing?this.currentGameSolutionGuessing===this.currentGameSolutionActual?this.GetIsAIGenerated()?this.ShareWin(null):this.HandleNewGameClick():this.getCurrentDaily||this.appStateForceAutoCheck?this.getSubmitButtonText===this.appDataActionButtonTexts.quit?(this.appDataConfirmationObject={message:"Give up and see the solution?",target:"quit"},this.appStateShowConfirmation=!0):this.IsCurrentGuessCorrect():this.ShareBoard():this.FillParkingLot()},GetUserStartedGame(t){return this.appDataUserDailyGamesStarted.find((e=>e.key===t.key))},HasUserStartedGame(t){let e=!1;return e=!!this.GetUserStartedGame(t),e},HandleOldGameClick(t,e,a=!1){note("HandleOldGameClick() called"),null!==t&&(t.preventDefault(),t.stopPropagation());let s=["?"];if(this.currentGameSolutionGuessing="",this.appDataMessage="",s.push("sendingName=Player 1"),s.push("&generated="+encodeURIComponent(this.getIsAIGenerating?this.getIsAIGenerating:e.generated)),s.push("&key="+encodeURIComponent(e.key)),s.push("&puzzleName=Player 1"),s.push("&puzzleID="+encodeURIComponent(e.puzzleID)),s.push("&lang="+encodeURIComponent(e.lang)),s.push("&wordSetID="+encodeURIComponent(e.wordSetID)),s.push("&useExtraCard="+encodeURIComponent(e.useExtraCard)),s.push("&sol="+encodeURIComponent(e.sol)),s.push("&board="+encodeURIComponent(e.board)),this.appCurrentDailyGameKey=-1,e.date&&e.key){if(s.push("&key="+encodeURIComponent(e.key)),!this.HasUserStartedGame(e)){let t={key:e.key,guesses:0,solved:!1};this.appDataUserDailyGamesStarted.push(t),localStorage.setItem("dailyGames",JSON.stringify(this.appDataUserDailyGamesStarted))}this.appCurrentDailyGameKey=e.key}let i=s.join(""),r=location.origin+i;log(r),history.pushState(null,null,r),this.appStateShowDailyGames&&this.ToggleShowDailyGames(t),this.appStateShowMeta||this.ToggleShowMeta(t),this.appStateShowGlobalCreated&&this.ToggleShowGlobalCreated(t),this.LoadPage(),this.appStateShowNotification=!0,this.RotateTray(-4)},HandleGoButtonClick(t){note("HandleGoButtonClick() called"),this.SubmitSettings(t),this.appStateShowCatChooser=!1},HandleNewGameClick(){note("HandleNewGameClick() called"),this.GetCategoryNames(),this.appStateShowCatChooser=!0},HandleGameLinkClick(t,e){note("HandleGameLinkClick() called"),t.stopPropagation(),t.preventDefault(),e.solved&&e.guesses>0?this.HandleSolvedPuzzleButtonClick(t,e):this.HandleOldGameClick(t,e)},HandleSolvedPuzzleButtonClick(t,e){note("HandleSolvedPuzzleButtonClick() called"),t.stopPropagation(),t.preventDefault(),this.appStateSolving=!0,this.HandleOldGameClick(t,e,!0),this.appStateShowNotification=!1,setTimeout((()=>{this.SolvePuzzleCurrent(),this.appStateSolving=!1,this.appStateShowNotification=!1,history.pushState(null,null,window.location.origin+window.location.pathname)}),150)},SolvePuzzleCurrent(){note("SolvePuzzleCurrent() called");let t=this.currentGameSolutionActual.split(":"),e=t[0],a=this.appDataHints.findIndex((t=>t.value===e));this.RotateTrayBasedOnInputFocus(a,!1);let s=[parseInt(t[1]),parseInt(t[4]),parseInt(t[7]),parseInt(t[10])];for(let t=0;t<this.appDataCards.length;t++){const e=this.appDataCards[t];if(0===e.words.length){let a=this.appDataCardsParked.find((e=>e.words.find((e=>e.id===s[t]))));if(a){let i=a.words.findIndex((e=>e.id===s[t])),r=0;switch(t){case 1:r=1;break;case 2:r=-1;break;case 3:r=2;break}a.rotation=4-i+r,this.SwapCards(e,a)}}}this.ResetCardsAfterRotation(),this.IsCurrentGuessCorrect()},HandleYesNo(t,e){switch(note("HandleYesNo() called"),t){case"quit":this.getCurrentDaily.quit=!0,this.SolvePuzzleCurrent();break;case"correct":this.ShareBoard(e);break;case"newgame":e&&this.NewGame(null);break;case"creator":e&&(confirm=window.confirm(`Are you sure you are, (${this.appDataPlayerCreator.name}), the original creator?`),confirm&&(this.tempID=this.appDataPlayerCreator.id,this.appDataPlayerCurrent.id=this.appDataPlayerCreator.id,this.appDataPlayerCurrent.role="reviewer",localStorage.setItem("userID",this.appDataPlayerCurrent.id)));break;default:break}this.appStateShowConfirmation=!1,this.appStateIsModalShowing=!1},HandlePointerMoveEvent(t){t.clientX,this.appDataGhostX,t.clientY,this.appDataGhostY;this.appDataGhostX=t.clientX,this.appDataGhostY=t.clientY},HandleBodyPointerUp(t,e){this.appStateShareError=!1,this.appStateIsModalShowing?this.appDataDraggedCard.isSelected=!1:(this.appStateIsDragging=!1,this.appDataDraggedCard=this.appDataEmptyCard)},HandleBodyPointerDown(t){this.appDataGhostX=t.clientX,this.appDataGhostY=t.clientY},HandleCardPointerDown(t,e){null!==t&&(t.preventDefault(),t.stopPropagation(),this.appDataGhostX=t.clientX,this.appDataGhostY=t.clientY,t.target.hasPointerCapture(t.pointerId)&&t.target.releasePointerCapture(t.pointerId)),this.appDataDraggedCard=e,this.appStateIsDragging=!0},HandleCardPointerUp(t,e){if(t.preventDefault(),t.stopPropagation(),this.appDataMessage="",this.getSelectedCard&&this.getSelectedCard===e)return this.appDataDraggedCard=this.appDataEmptyCard,void(this.appStateIsDragging=!1);this.appDataDraggedCard.words.length>0&&this.SwapCards(e,this.appDataDraggedCard)},ScrollParking(t,e){note("ScrollParking() called");const a=document.getElementById("parking"),s=parseInt(this.cssStyles.getPropertyValue("--cardSize")),i=parseFloat(this.cssStyles.getPropertyValue("--scale"));"left"===e?this.appDataParkingScrollLeft=a.scrollLeft+2*i*s:"right"===e?this.appDataParkingScrollLeft=a.scrollLeft-2*i*s:"beginning"===e&&(this.appDataParkingScrollLeft=0),a.scrollTo({left:this.appDataParkingScrollLeft,behavior:"smooth"}),setTimeout((()=>{this.appParkingRightButtonDisabled=a.scrollWidth-a.clientWidth<=a.scrollLeft}),300)},HandlePageVisibilityChange(){note("HandlePageVisibilityChange() called"),document.hidden||this.GetDailyGames()},CancelSettings(t){note("CancelSettings() called"),null!==t&&(t.preventDefault(),t.stopPropagation()),this.appStateIsModalShowing=!1,this.appStateShowSettings=!1,this.appStateShowIntro=!1,this.tempID=this.appDataPlayerCurrent.id,this.tempUseMultiColoredGems=this.userSettingsUseMultiColoredGems,this.tempUseWordSetThemes=this.userSettingsUseWordSetThemes,this.tempUserWantsDailyReminder=this.userSettingsUserWantsDailyReminder,this.tempUserSettingsLanguage=this.userSettingsLanguage,this.tempUserSettingsUsesLightTheme=this.userSettingsUsesLightTheme,this.tempUseExtraCard=this.userSettingsUseExtraCard,this.tempUserSettingsUsesSimplifiedTheme=this.userSettingsUsesSimplifiedTheme,this.tempUserSettingsShowAllCards=this.userSettingsShowAllCards},HandleIntroButtonClick(t){note("HandleIntroButtonClick() called"),this.SubmitSettings(null),this.appStateShowOOBE=!0},async SubmitSettings(t){if(note("SubmitSettings() called"),null!==t&&(t.preventDefault(),t.stopPropagation()),this.appDataPlayerCurrent.name=""!==this.tempName?this.tempName.trim():this.appDataPlayerCurrent.name,this.appStateIsGuessing||(this.appDataPlayerCreator.name=this.appDataPlayerCurrent.name),localStorage.setItem("name",this.appDataPlayerCurrent.name),this.appStateShowSettings||this.appStateShowCatChooser){this.userSettingsLanguage=this.tempUserSettingsLanguage;let e=this.tempWordSets.find((t=>t.name===this.tempWordSetName));this.SelectWordSet(t,e);let a=!1;a=this.appDataWordSets.find((t=>!0===t.isSelected)).id!==this.tempWordSets.find((t=>!0===t.isSelected)).id,this.appDataWordSets=this.tempWordSets,this.currentGameWordSet=this.appDataWordSets.find((t=>!0===t.isSelected)),(a&&!this.appStateIsGuessing||this.appStateShowCatChooser)&&(this.NewGame(),this.SetWordSetTheme(this.currentGameGuessingWordSet));let s=this.appDataPlayerCurrent.id!==this.tempID;this.appDataPlayerCurrent.id=this.tempID,this.userSettingsUseWordSetThemes=this.tempUseWordSetThemes,this.userSettingsUserWantsDailyReminder=this.tempUserWantsDailyReminder,this.userSettingsUseExtraCard=this.tempUseExtraCard,this.ToggleUseLightTheme(this.tempUserSettingsUsesLightTheme),this.ToggleUseSimplifedTheme(this.tempUserSettingsUsesSimplifiedTheme),this.ToggleShowAllCards(this.tempUserSettingsShowAllCards),this.userSettingsUseMultiColoredGems=this.tempUseMultiColoredGems,this.currentGameGuessingCardCount=this.userSettingsUseExtraCard?5:4,this.SetWordSetTheme(this.currentGameGuessingWordSet),localStorage.setItem("userID",this.appDataPlayerCurrent.id),localStorage.setItem("useWordSetThemes",this.userSettingsUseWordSetThemes),localStorage.setItem("userSettingsUserWantsDailyReminder",this.userSettingsUserWantsDailyReminder),localStorage.setItem("userSettingsLanguage",this.userSettingsLanguage),localStorage.setItem("userSettingsUsesLightTheme",this.userSettingsUsesLightTheme),localStorage.setItem("userSettingsUsesSimplifiedTheme",this.userSettingsUsesSimplifiedTheme),localStorage.setItem("userSettingsShowAllCards",this.userSettingsShowAllCards),localStorage.setItem("useMultiColoredGems",this.userSettingsUseMultiColoredGems),localStorage.setItem("useExtraCard",this.userSettingsUseExtraCard),localStorage.setItem("wordSet",this.currentGameWordSet.id),s&&(await this.GetDailyGameStats(),window.location.reload())}this.appStateIsModalShowing=!1,this.appStateShowSettings=!1,this.appStateShowIntro=!1},GetUserSettings(){note("GetUserSettings() called");let t=localStorage.getItem("userID");null!=t?(t=JSON.parse(t),this.appDataPlayerCurrent.id=t):(this.appDataPlayerCurrent.id=getRandomInt(1e7,1e8),localStorage.setItem("userID",this.appDataPlayerCurrent.id),this.appStateShowOOBE=""!==window.location.search),this.tempID=parseInt(this.appDataPlayerCurrent.id);let e=localStorage.getItem("dailyGames");null!=e&&(this.appDataUserDailyGamesStarted=JSON.parse(e));let a=localStorage.getItem("name");null!=a?this.appDataPlayerCurrent.name=a:(this.appStateIsModalShowing=!0,this.appStateShowIntro=!0,setTimeout((()=>{document.getElementById("nameInput").focus()}),410)),this.appDataWordSets.forEach((t=>{t.isSelected=!1}));let s=localStorage.getItem("wordSet");null!=s&&this.appDataWordSets.find((t=>t.id===s))?this.currentGameWordSet=this.appDataWordSets.find((t=>t.id===s)):this.currentGameWordSet=WordSets.find((t=>"100"===t.id)),this.currentGameWordSet.isSelected=!0;let i=localStorage.getItem("userSettingsLanguage");null!=i&&(this.userSettingsLanguage=i,this.tempUserSettingsLanguage=this.userSettingsLanguage);let r=localStorage.getItem("useWordSetThemes");null!=r&&(this.userSettingsUseWordSetThemes=JSON.parse(r),this.tempUseWordSetThemes=this.userSettingsUseWordSetThemes,this.SetWordSetTheme(this.currentGameWordSet));let o=localStorage.getItem("userSettingsUserWantsDailyReminder");null!=o&&(this.userSettingsUserWantsDailyReminder=JSON.parse(o),this.tempUserWantsDailyReminder=this.userSettingsUserWantsDailyReminder),this.appStateIsGuessing?this.documentCssRoot.style.setProperty("--wordScale",this.currentGameGuessingWordSet.scale):this.documentCssRoot.style.setProperty("--wordScale",this.currentGameWordSet.scale);let n=localStorage.getItem("useExtraCard");null!=n&&(this.userSettingsUseExtraCard=JSON.parse(n),this.tempUseExtraCard=this.userSettingsUseExtraCard);let p=localStorage.getItem("userSettingsUsesLightTheme");null!=p&&(this.ToggleUseLightTheme(JSON.parse(p)),this.tempUserSettingsUsesLightTheme=this.userSettingsUsesLightTheme);let l=localStorage.getItem("userSettingsUsesSimplifiedTheme");null!=l&&(this.ToggleUseSimplifedTheme(JSON.parse(l)),this.tempUserSettingsUsesSimplifiedTheme=this.userSettingsUsesSimplifiedTheme);let h=localStorage.getItem("userSettingsShowAllCards");null!=h&&(this.ToggleShowAllCards(JSON.parse(h)),this.tempUserSettingsShowAllCards=this.userSettingsShowAllCards);let d=localStorage.getItem("useMultiColoredGems");null!=d&&(this.userSettingsUseMultiColoredGems=JSON.parse(d),this.tempUseMultiColoredGems=this.userSettingsUseMultiColoredGems)},HandleKeyDownEvent(t){if(!t.metaKey&&!t.ctrlKey&&!t.altKey)switch(t.key){case"Enter":note("HandleKeyDownEvent() called"),t.preventDefault(),this.appStateShowSettings||this.appStateShowTutorial||this.appStateShowIntro||this.appStateShowInfo||this.appStateShowConfirmation||this.appStateIsGuessing||4!==this.getNumberOfHintsThatHaveBeenFilled||this.FillParkingLot(),this.appStateShowSettings?this.SubmitSettings(t):this.appStateShowTutorial?(this.appStateShowOOBE=!1,this.ToggleShowTutorial(null)):this.appStateShowIntro?this.HandleIntroButtonClick(null):this.appStateShowConfirmation?this.HandleYesNo(this.appDataConfirmationObject.target,!0):this.appStateShowInfo?this.appStateShowInfo=!1:this.appStateShowGlobalCreated?this.appStateShowGlobalCreated=!1:this.appStateShowCatChooser&&this.HandleGoButtonClick(t);break;case"Tab":note("HandleKeyDownEvent() called"),t.preventDefault(),this.appStateTrayIsRotating||this.RotateTray(t.shiftKey?1:-1);break;case":":case"?":case"&":case"=":t.preventDefault(),t.stopPropagation();case"Escape":this.appStateShowOOBE=!1,this.appStateShowSettings?this.CancelSettings(null):this.appStateShowDailyGames?this.ToggleShowDailyGames(null):this.appStateShowTutorial?this.ToggleShowTutorial(null):this.appStateShowCatChooser?this.appStateShowCatChooser=!1:this.appStateShowConfirmation?this.HandleYesNo(this.appDataConfirmationObject.target,!1):this.appStateShowInfo?this.appStateShowInfo=!1:this.appStateShowGlobalCreated?this.appStateShowGlobalCreated=!1:this.appStateShowNotification?this.appStateShowNotification=!1:this.appStateShowMeta?this.appStateShowMeta=!1:this.appStateShowMeta||(this.appStateShowMeta=!0);break;default:}},HandleResize(){this.appStateUsePortraitLayout=document.body.offsetWidth/document.body.offsetHeight<.75},HandlePopState(){note("HandlePopState() called"),window.location.search?this.LoadPage():this.NewGame(null)},ShareWin(t,e=this.getCurrentDaily){if(null!==t&&(t.stopPropagation(),t.preventDefault()),note("ShareWin() called"),e.solved){let t=e&&this.getTodaysDaily===e?"Today's":`The ${e.date}`,a=`I solved ${t} Daily in ${e.guesses} tries! ðŸ˜€\nCan you do better?\n\n<https://facets.bigtentgames.com>`;this.ConstructAndSetShareURLForCurrentGame(),1===e.guesses&&(a=`ðŸ¥³ I solved ${t} Daily in 1 try! Can you?\n\n<https://facets.bigtentgames.com>`),e.quit&&(a=`ðŸ˜± I gave up on ${t} Daily! Can you solve it?\n\n<https://facets.bigtentgames.com>`),this.ShareText(a,""),history.pushState(null,null,window.location.origin+window.location.pathname)}},async CopyTextToClipboard(t){navigator.clipboard?window.ClipboardItem?await navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"})})]).then((()=>{note("Attempting to copy via navigator.clipboard.write"),this.appDataMessage="Message copied to the clipboard.",this.appStateShowNotification=!0})).catch((e=>{error(e),this.CopyToClipboardViaExecCommand(t)})):await navigator.clipboard.writeText(t).then((()=>{note("Attempting to copy via navigator.clipboard.writeText"),this.appDataMessage="Message copied to the clipboard.",this.appStateShowNotification=!0})).catch((e=>{error(e),this.CopyToClipboardViaExecCommand(t)})):this.CopyToClipboardViaExecCommand(t)},async CopyToClipboardViaExecCommand(t){note("CopyToClipboardViaExecCommand() called");copyToClipboard(t);this.appDataMessage=""},async ShareText(t,e){if(note("ShareText() called"),!this.getIsAIGenerating){this.appDataMessage="",note("_text = "+t),note("_url = "+e);let a={text:t+(""===e?"":" <"+e+">")};navigator.canShare&&!navigator.canShare(a)&&(a={text:t,url:""===e?window.location.origin:e}),navigator.share&&navigator.canShare(a)?await navigator.share(a).then((t=>{note("Message shared via navigator.share()")})).catch((a=>{this.CopyTextToClipboard(t+(""===e?"":" <"+e+">")),error("Failed to share via navigator.share(): ",a)})):this.CopyTextToClipboard(t+(""===e?"":" <"+e+">"))}},async ShareBoard(t=!1,e=!1){if(note("ShareBoard() called"),!this.getIsAIGenerating&&this.isChromeAndiOSoriPadOS&&-1!==this.appDataShareURL.indexOf("facets.bigtentgames.com/game/?"))this.CopyTextToClipboard(this.GetShareTextBasedOnContext(t)+" <"+this.appDataShareURL+">"),note("Shortened URL exists, copying to clipboard");else{let s="reviewer"===this.appDataPlayerCurrent.role&&4===this.getNumberOfCardsThatHaveBeenPlacedOnTray,i=this.GetShareTextBasedOnContext(t);this.ConstructAndSetShareURLForCurrentGame(s,e),this.appStateIsGettingTinyURL=!0;var a=(this.getIsAIGenerating?"https://flat-night-eecc.bigtentgames.workers.dev/":"https://worker-winter-glade-cd02.bigtentgames.workers.dev/")+location.search.substring(1);note("Fetching short url"),await fetch(a,{method:"GET",headers:{Host:window.location.hostname,Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"Content-Type"}}).then((t=>t.ok?t.text():t.text().then((t=>{const e=JSON.parse(t);error("("+e.statusCode+") "+e.message)})))).then((t=>{this.appDataShareURL=location.origin+"/game/?"+t,this.ShareText(i,this.appDataShareURL)})).catch((t=>{error(t),UseDebug||(this.appStateShareError=!0)})).finally((()=>{this.appStateIsGettingTinyURL=!1})),UseDebug&&this.ShareText(i,this.appDataShareURL)}},ReportPuzzle(t){note("ReportPuzzle() called"),location.href="mailto:bigtentgames@icloud.com?subject=Facets Puzzle Reported&body=Puzzle ID# "+t.key+"%0D%0A This puzzle contains offensive language.%0D%0A"+t.hints},ConstructAndSetShareURLForCurrentGame(t,e=!1){if(note("ConstructAndSetShareURLForCurrentGame() called"),this.appStateIsGuessing){this.currentGameSolutionGuessing!==this.currentGameSolutionActual&&(this.currentGameSolutionGuessing="");let a="",s="";this.appDataCards.concat(this.appDataCardsParked).forEach((t=>{0===t.words.length&&(s+="::::"),t.words.forEach((t=>{s+=t.id+":"}))})),this.appDataHints.forEach(((t,e)=>{t.value=t.value.trim();let a=encodeURIComponent(t.value);s+=a+(e===this.appDataHints.length-1?"":":")})),a=encodeURIComponent(a),a+="?sendingName="+encodeURIComponent(this.appDataPlayerCurrent.name),a+="&generated="+encodeURIComponent(!!this.getCurrentDaily||this.getIsAIGenerating),this.getCurrentDaily&&(a+="&key="+encodeURIComponent(this.getCurrentDaily.key),this.getCurrentDaily.quit&&(a+="&quit=true")),a+="&puzzleName="+encodeURIComponent(this.appDataPlayerCreator.name),a+="&puzzleID="+encodeURIComponent(this.appDataPlayerCreator.id),a+="&lang="+(!1===e?encodeURIComponent(this.currentGameLanguage):encodeURIComponent(this.userSettingsLanguage)),a+="&wordSetID="+encodeURIComponent(this.currentGameGuessingWordSet.id),e&&(a+="&isNew=true"),a+="&sendingID="+encodeURIComponent(this.appDataPlayerCurrent.id),a+="&useExtraCard="+encodeURIComponent(5===this.currentGameGuessingCardCount),a+="&sol="+encodeURIComponent(this.currentGameSolutionActual),t&&(a+="&final=true"),a=window.location.origin+window.location.pathname+a+"&board="+s,this.appDataShareURL=a,history.pushState(null,null,this.appDataShareURL)}},GetMessageBasedOnTrayCount(t,e){note("GetMessageBasedOnTrayCount() called");let a=this.getNumberOfCardsThatHaveBeenPlacedOnTray,s="";this.getNumberOfCardsThatHaveBeenPlacedOnTray<4&&(s=a+"/4 "),4!==a||"reviewer"!==this.appDataPlayerCurrent.role||t||(a=5);let i=LevelMessage[a][getRandomInt(0,LevelMessage[a].length)],r=""!==e,o=r?e+", ":"",n=r&&0!==i.indexOf("I ");i=n?i.charAt(0).toLowerCase()+i.slice(1):i;let p=s+LevelEmoji[a][getRandomInt(0,LevelEmoji[a].length)]+" "+o+i;return 4===a&&this.getCurrentDaily&&this.getCurrentDaily.quit&&(p="AI is hard! We're working hard to make these Daily Games better to play."),announce(p),p},GetShareTextBasedOnContext(t){note("GetShareTextBasedOnContext() called");let e="",a=this.currentGameGuessingWordSet.startsWithVowel?"an ":"a ";return a=5===this.currentGameGuessingCardCount?"a ":a,e=this.appDataPlayerCurrent.id===this.appDataPlayerSender.id&&this.appDataPlayerCurrent.id===this.appDataPlayerCreator.id?"ðŸ§ "+this.currentGameGuessingWordSet.emoji+(5===this.currentGameGuessingCardCount?"â­ï¸":"")+" I created "+a+(5===this.currentGameGuessingCardCount?"5-card ":"")+'"'+this.currentGameGuessingWordSet.name+'" word puzzle for you to solve!':"reviewer"===this.appDataPlayerCurrent.role?this.GetMessageBasedOnTrayCount(t,this.currentGameGuessersName):"ðŸ¤” "+this.appDataPlayerCreator.name+", here's my guess!",e},SwapCards(t,e){note("SwapCards() called");let a=new CardObject(t),s=new CardObject(e);t.words=s.words,t.rotation=s.rotation,t.isSelected=!1,t.justDropped=!0,e.words=a.words,e.rotation=a.rotation,e.isSelected=!1,e.justDropped=!0,setTimeout((()=>{this.appDataCards.concat(this.appDataCardsParked).forEach((t=>{t.justDropped=!1}))}),this.appDataTransitionLong),this.appStateIsDragging=!1,this.appDataDraggedCard=this.appDataEmptyCard,this.ConstructAndSetShareURLForCurrentGame()},HandleCardClick(t,e){t.preventDefault(),t.stopPropagation(),this.ToggleCardSelection(e)},ToggleCardSelection(t){if(note("ToggleCardSelection() called"),this.getSelectedCard&&this.getSelectedCard!==t)return void this.SwapCards(this.getSelectedCard,t);let e=!t.isSelected;this.appDataCards.forEach((t=>{t.isSelected=!1,t.isInTray=!0,t.justDropped=!1})),this.appDataCardsParked.forEach((t=>{t.isSelected=!1,t.isInTray=!1,t.justDropped=!1})),t.isSelected=0!==t.words.length&&e,document.body.offsetHeight<=660&&!this.appStateIsModalShowing&&(this.appStateIsModalShowing=!0),t.isSelected&&(this.appDataDraggedCard=t)},RotateCard(t,e,a){note("RotateCard() called"),t.preventDefault(),t.stopPropagation(),this.appDataTransitionShort=parseInt(getComputedStyle(document.body).getPropertyValue("--mediumTransition").replace("ms","")),this.appStateIsGuessing&&(!this.vsUseFocus||this.vsUseFocus&&"parking"!==t.target.parentElement.parentElement.id)&&(this.appDataMessage="",this.appDataTimeoutCardRotation&&(clearTimeout(this.appDataTimeoutCardRotation),this.appDataTimeoutCardRotation=null),e.isSelected=!1,e.rotation=e.rotation+a,e.isRotating=!0,this.appDataTimeoutCardRotation=setTimeout((()=>{this.ResetCardsAfterRotation()}),this.appDataTransitionShort))},ResetCardsAfterRotation(t=!0){note("ResetCardsAfterRotation() called"),this.appDataCards.concat(this.appDataCardsParked).forEach((t=>{if(0!==t.rotation){t.isRotating=!1;let e=t.words.length;if(e>0){let a=(t.rotation%e+e)%e;t.words=t.words.slice(-a).concat(t.words.slice(0,-a))}t.rotation=0}})),this.appStateIsGuessing&&t&&this.ConstructAndSetShareURLForCurrentGame()},RotateTrayBasedOnInputFocus(t,e=!0){if(note("RotateTrayBasedOnInputFocus() called"),0!=t)switch(t){case 0:this.RotateTray(0,e);break;case 1:this.RotateTray(-1,e);break;case 2:this.RotateTray(1,e);break;case 3:this.RotateTray(-2,e);break}},RotateTray(t,e=!0){if(note("RotateTray() called"),!this.appStateTrayIsRotating)if(this.appDataMessage="",this.appStateTrayIsRotating=!0,this.appDataTimeoutTrayRotation&&(clearTimeout(this.appDataTimeoutTrayRotation),this.appDataTimeoutTrayRotation=null),this.getSelectedCard&&(this.getSelectedCard.isSelected=!1),this.appStateTrayRotation=this.appStateTrayRotation+t,document.getElementById("parkingInput").focus(),e&&!this.appStateSolving)this.appDataTimeoutTrayRotation=setTimeout((()=>{this.ResetTrayAfterRotation()}),this.appDataTransitionLong),this.appStateIsGuessing||setTimeout((()=>{let t=document.getElementById("hint0");this.appDataParkingInputValue="",t.focus()}),this.appDataTransitionLong);else if(this.ResetTrayAfterRotation(),!this.appStateIsGuessing){let t=document.getElementById("hint0");this.appDataParkingInputValue="",t.focus()}},ResetTrayAfterRotation(){if(note("ResetTrayAfterRotation() called"),this.appStateTrayIsRotating=!1,this.appDataParkingInputValue="",this.appStateTrayRotation<3){if(0!==this.appStateTrayRotation){let t=this.appDataHints.length;if(t>0){let e=(this.appStateTrayRotation%t+t)%t;this.appDataHints=this.appDataHints.slice(-e).concat(this.appDataHints.slice(0,-e))}}let t=this.appDataHints[0],e=this.appDataHints[1],a=this.appDataHints[2],s=this.appDataHints[3],i=this.appDataCards[0],r=this.appDataCards[1],o=this.appDataCards[2],n=this.appDataCards[3];switch(i.rotation=r.rotation=o.rotation=n.rotation=this.appStateTrayRotation,this.ResetCardsAfterRotation(!1),this.appStateTrayRotation){case-1:this.appDataHints[0]=t,this.appDataHints[1]=a,this.appDataHints[2]=s,this.appDataHints[3]=e,this.appDataCards[0]=r,this.appDataCards[2]=i,this.appDataCards[1]=n,this.appDataCards[3]=o;break;case 1:this.appDataHints[0]=s,this.appDataHints[1]=e,this.appDataHints[2]=t,this.appDataHints[3]=a,this.appDataCards[0]=o,this.appDataCards[1]=i,this.appDataCards[2]=n,this.appDataCards[3]=r;break;case 2:case-2:this.appDataHints[0]=e,this.appDataHints[1]=t,this.appDataHints[2]=s,this.appDataHints[3]=a,this.appDataCards[0]=n,this.appDataCards[1]=o,this.appDataCards[2]=r,this.appDataCards[3]=i;break;default:break}this.ConstructAndSetShareURLForCurrentGame()}this.appStateTrayRotation=0},GetScrollSize(){const t=document.getElementById("parking");return t.scrollWidth-t.clientWidth},ConvertToDateFromKey(t){let e=t.substring(2,4),a=t.substring(4,8),s=t.substring(0,2)-1;return new Date(a,s,e)},GetDateFormatted(t,e=!1){const a=e?0:1;let s=String(t.getDate()).padStart(2,"0"),i=String(t.getMonth()+a).padStart(2,"0"),r=t.getFullYear(),o=i+s+r;if(e){let t=new Date(r,i,s),e={month:"short",day:"numeric"};o=new Intl.DateTimeFormat(void 0,e).format(t)}return o},GetIsAIGenerated(){if(this.getCurrentDaily)return!0;if(window.location.search){let t=new URLSearchParams(window.location.search);return t.has("generated")&&"true"===t.get("generated").toString()}return!1},GetBoardFromURL(){let t=[];if(window.location.search){let e=new URLSearchParams(window.location.search);UseDebug=!!e.has("useDebug")||UseDebug;let a=decodeURIComponent(window.location.search);params=a.split("?")[1].split("&"),t=e.has("board")?e.get("board").split(":"):[]}return t},async NewGame(t,e="",a=!0){note("NewGame() called"),document.title="Facets!",this.appDataMessage=e,this.currentGameGuessCount=0,this.appCurrentDailyGameKey=-1,this.currentGameLanguage="",this.currentGameReviewIsFinal=!1,this.currentGameGuessersName="",this.appDataPlayerCurrent.role="creator",this.appDataPlayerCreator.id=this.appDataPlayerCurrent.id,this.appDataPlayerCreator.name=this.appDataPlayerCurrent.name,this.appDataPlayerSender.id=this.appDataPlayerCurrent.id,this.appDataPlayerSender.name=this.appDataPlayerCurrent.name,this.currentGameGuessingWordSet=this.currentGameWordSet,this.currentGameGuessingCardCount=this.userSettingsUseExtraCard?5:4,this.currentGameSolutionGuessing="",this.appStateTrayIsRotating=!1,this.appStateForceAutoCheck=!1,this.appStateShowMeta=!1,this.SetWordSetTheme(this.currentGameWordSet),this.appDataShareURL="",history.pushState(null,null,window.location.origin+window.location.pathname),this.appStateIsGuessing=!1,this.appDataCards=[],this.appDataCardsParked=[new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({}),new CardObject({})],this.appDataHints=[new WordObject({}),new WordObject({}),new WordObject({}),new WordObject({})],await this.CreateCardsForPlayer(null),a&&this.RotateTray(-4)},async LoadPage(){note("LoadPage() called"),this.GetUserSettings(),announce("Player "+this.appDataPlayerCurrent.id+" has loaded v"+this.appDataVersion),this.GetDailyGames(),this.GetLast10GlobalCreatedGames(),this.appDataTransitionLong=parseInt(getComputedStyle(document.body).getPropertyValue("--longTransition").replace("ms","")),this.appDataTransitionShort=parseInt(getComputedStyle(document.body).getPropertyValue("--shortTransition").replace("ms","")),this.appStatePageHasLoaded=!0;let t=this.GetBoardFromURL();try{t.length>=40?(document.title="Facets!",this.ToggleShowMeta(null),this.RestoreGame(t)):this.appStateIsGuessing||(this.getIsAIGenerating&&(this.currentGameGuessingCardCount=4,this.appDataPlayerCurrent.id=0,this.currentGameWordSet=this.getEnabledWordSets.find((t=>"100"===t.id)),log(this.currentGameWordSet.name),this.SelectWordSet(null,this.currentGameWordSet),note(this.currentGameWordSet.name),setTimeout((()=>{this.GetAISolution()}),2e3)),this.NewGame(null,"",!1),this.ToggleShowMeta(null))}catch(e){error(e.message),t=[],this.NewGame(null,"ðŸ˜• - Something went wrong.",!1)}this.appStateUsePortraitLayout=document.body.offsetHeight>document.body.offsetWidth},DeregisterServiceWorkers(){"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(t){for(let e of t)e.unregister()})).catch((function(t){}))},EnableDailyReminders(){return new Promise(((t,e)=>{"granted"===Notification.permission?t(!0):Notification.requestPermission().then((e=>{"granted"===e?(this.HandleServiceWorkerRegistration(),t(!0)):t(!1)})).catch((t=>{e(t)}))}))},HandleServiceWorkerRegistration(){note("HandleServiceWorkerRegistration() called")},HandleVersionAvailable(){note("HandleVersionAvailable() called")}},mounted(){this.LoadPage(),this.DeregisterServiceWorkers(),window.addEventListener("keydown",this.HandleKeyDownEvent),window.addEventListener("pointermove",this.HandlePointerMoveEvent),window.addEventListener("visibilitychange",this.HandlePageVisibilityChange),window.addEventListener("resize",this.HandleResize),window.addEventListener("popstate",this.HandlePopState)},watch:{userSettingsLanguage:function(t,e){this.LoadTranslatedWords()}},computed:{getSelectedCard:function(){return this.appDataCards.concat(this.appDataCardsParked).find((t=>!0===t.isSelected))},getAllPlayerCards:function(t){return this.appDataCards.concat(this.appDataCardsParked).find((e=>e.id.indexOf(0===t)))},getAllCards:function(){let t=this.appDataCards.concat(this.appDataCardsParked).filter((t=>t.words.length>0));return t.forEach((t=>{t.id=this.GetUniqueCardId(t.words)})),t=t.sort(((t,e)=>t.id-e.id)),t},getFirstThreeParkedCards:function(){return this.appDataCardsParked.splice(0,3)},getFullCardsInTray:function(){return this.appDataCards.filter((t=>t.words.length>0))},getEmptyCardsInTray:function(){return this.appDataCards.filter((t=>0===t.words.length))},getNumberOfCardsThatHaveBeenPlacedOnTray:function(){return void 0===this.appDataCards?0:this.getFullCardsInTray.length},getNumberOfHintsThatHaveBeenFilled:function(){return void 0===this.appDataHints?0:this.appDataHints.filter((t=>""!=t.value)).length},getUniqueCardId:function(t){return this.GetUniqueCardId(t)},getFirstAvailableParkingSpot:function(){return this.appDataCardsParked.find((t=>0===t.words.length))},getPlayerMessage:function(){clearTimeout(this.appDataTimeoutNotification);let t=2e3,e=this.currentGameGuessingWordSet.startsWithVowel?"an":"a",a=this.appStateForceAutoCheck?e:this.appDataPlayerCreator.name+"'s ",s="";if(""!==this.appDataMessage)s=this.appDataMessage;else if(this.appStateIsGuessing||-1===this.appDataPlayerCurrent.id)if(this.appDataPlayerCurrent.id===this.appDataPlayerSender.id&&-1!==this.appDataPlayerCurrent.id&&this.appDataPlayerCurrent.id===this.appDataPlayerCreator.id)s=`${this.appDataPlayerCurrent.name}, this is your own puzzle!`;else if(this.currentGameReviewIsFinal&&-1!==this.appDataPlayerCurrent.id)s=`${this.appDataPlayerCurrent.name}, here's the solution.`;else if(this.appDataPlayerCurrent.id!==this.appDataPlayerSender.id&&this.appDataPlayerCurrent.id===this.appDataPlayerCreator.id&&-1!==this.appDataPlayerCurrent.id)s=`You are reviewing ${this.appDataPlayerSender.name}'s guess!`;else if(this.getCurrentDaily){new Date;s=`<name>The Daily â€“ ${this.getCurrentDaily.date.split(",")[0]}</name><subtitle>Puzzle category â€“ "${this.currentGameGuessingWordSet.name}"</subtitle>`,this.getCurrentDaily.key===this.getTodaysDaily.key&&(s=`The Daily â€“ Today<subtitle>Puzzle category â€“  "${this.currentGameGuessingWordSet.name}"</subtitle>`)}else s=`You are guessing ${a} "${this.currentGameGuessingWordSet.name}" puzzle!`;else s=`You are creating a new "${this.currentGameGuessingWordSet.name}" puzzle!`,t=1700;return this.appDataTimeoutNotification=setTimeout((()=>{this.appStateShowNotification=!1}),t),s},getEnabledWordSets:function(){return this.appDataWordSets.filter((t=>t.enabled))},getEnabledTempWordSets:function(){return this.tempWordSets.filter((t=>t.enabled))},getEnabledTempWordSetNames:function(){let t=[];return this.appDataWordSets.forEach((e=>{e.enabled&&t.push(e.name)})),t.sort(((t,e)=>t.localeCompare(e,void 0,{sensitivity:"base"})))},getEnabledTempWordSet:function(){let t=[];return this.appDataWordSets.forEach((e=>{e.enabled&&t.push(e)})),t.sort(((t,e)=>t.name.localeCompare(e.name,void 0,{sensitivity:"base"})))},getEnabledTempLanguages:function(){let t=[];return this.appDataLanguages.forEach((e=>{e.enabled&&t.push({name:e.name,tag:e.tag})})),t.sort(((t,e)=>t.name.localeCompare(e.name,void 0,{sensitivity:"base"})))},getCurrentSelectedTempWordSetName:function(){return this.appDataWordSets.find((t=>t.isSelected)).name},getSubmitButtonText:function(){let t=this.appDataActionButtonTexts.send;return this.appStateShareError?"Retry":("reviewer"===this.appDataPlayerCurrent.role?t=this.appDataActionButtonTexts.respond:"creator"===this.appDataPlayerCurrent.role&&(t=this.appDataActionButtonTexts.send),this.appDataPlayerCurrent.id!==this.appDataPlayerCreator.id&&(this.appStateForceAutoCheck&&(t=this.getCurrentDaily&&!this.getCurrentDaily.solved&&this.getCurrentDaily.guesses>1&&4!==this.getNumberOfCardsThatHaveBeenPlacedOnTray?this.appDataActionButtonTexts.quit:this.appDataActionButtonTexts.guess),this.isChromeAndiOSoriPadOS&&this.appDataShareURL.includes("facets.bigtentgames.com/game/?")&&(t=this.appDataActionButtonTexts.copy),this.currentGameSolutionGuessing===this.currentGameSolutionActual&&(t=this.getCurrentDaily?this.appDataActionButtonTexts.share:this.appDataActionButtonTexts.create)),t)},getCreatedGamesWithWordSetNames:function(){return this.appDataGlobalCreatedGames.map((t=>{const e=this.appDataWordSets.find((e=>e.id===t.wordSetID));return e?{...t,name:e.name}:t}))},getTodaysKey:function(){let t=new Date;return this.GetDateFormatted(t)},getTodaysDaily:function(){let t=new Date;return this.getDailyGamesWithWordSetNames.find((e=>e.key===this.GetDateFormatted(t)))},getCurrentDaily:function(){let t=this.getDailyGamesWithWordSetNames.find((t=>t.key===this.appCurrentDailyGameKey));return t||null},getDailyIsFreshToday:function(){if(void 0===this.getTodaysDaily)return!1;const t=0===this.getTodaysDaily.guesses&&!this.HasUserStartedGame(this.getTodaysDaily)&&!this.appStateIsGettingDailyGames&&!this.appStateIsGettingUserStats;return this.isBadgeSupported&&(t?navigator.setAppBadge():navigator.clearAppBadge()),t},getDailyGamesWithWordSetNames:function(){return this.appDataDailyGames.map((t=>{t.date=this.GetDateFormatted(this.ConvertToDateFromKey(t.key),!0);const e=this.appDataWordSets.find((e=>e.id===t.wordSetID));return e&&(t.name=e.name),t}))},isChromeAndiOSoriPadOS:function(){note("isChromeAndiOSoriPadOS() called");var t=navigator.userAgent||window.opera,e=/CriOS/.test(t)&&/iPhone|iPad|iPod/.test(t);return t=t.toLowerCase(),e||t.includes("firefox")&&t.includes("android")},getIsAIGenerating:function(){return-1!==window.location.href.indexOf(window.location.origin+"/generate.html")},getIsAIGenerated:function(){return this.GetIsAIGenerated()},getActionButtonState:function(){let t=!1;return 4!==this.getNumberOfCardsThatHaveBeenPlacedOnTray&&this.getCurrentDaily&&this.getCurrentDaily.guesses>1&&!this.getCurrentDaily.quit?t=!1:(4!==this.getNumberOfHintsThatHaveBeenFilled&&"creator"===this.appDataPlayerCurrent.role||4!==this.getNumberOfCardsThatHaveBeenPlacedOnTray&&"reviewer"!==this.appDataPlayerCurrent.role&&this.appDataPlayerCurrent.id!==this.appDataPlayerCreator.id)&&(t=!0),t},getCorrectCalIconClass:function(){let t=this.getCurrentDaily.date,e=parseInt(t.split(" ")[1]);const a=new Date;let s=new Date(a.getFullYear(),a.getMonth()+1,0).getDate()/12;return`cal${Math.ceil(e/s)}`},getResumeText:function(){let t="";switch(highlight(this.appDataPlayerCurrent.role),this.appDataPlayerCurrent.role){case"creator":t="Creating";break;case"reviewer":t="Reviewing";break;case"guesser":t="Guessing";break}return t},isSyncSupported:function(){return!!UseDebug||"SyncManager"in window},isNotificationSupported:function(){return!!UseDebug||"Notification"in window},isBadgeSupported:function(){return void 0!==navigator.setAppBadge&&null!==navigator.setAppBadge},isPWAOnHomeScreen:function(){return window.matchMedia("(display-mode: standalone)").matches}}});